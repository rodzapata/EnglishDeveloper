1
00:00:00,160 --> 00:00:02,159
Learn how to use Nest.js to build

2
00:00:02,159 --> 00:00:04,560
scalable back-end applications. In this

3
00:00:04,560 --> 00:00:06,080
course, you'll explore controllers,

4
00:00:06,080 --> 00:00:08,400
services, modules, decorators, pipes,

5
00:00:08,400 --> 00:00:10,559
guards, and exception handling, all

6
00:00:10,559 --> 00:00:12,960
while building the profile feature for

7
00:00:12,960 --> 00:00:16,000
Dev Match, a dating app for developers.

8
00:00:16,000 --> 00:00:18,480
You'll learn all about Nex.js's modular

9
00:00:18,480 --> 00:00:20,880
architecture, TypeScript support, and

10
00:00:20,880 --> 00:00:23,199
built-in tools to create clean, testable

11
00:00:23,199 --> 00:00:25,680
code. Don, the developer from Scribba,

12
00:00:25,680 --> 00:00:29,320
developed this course.

13
00:00:29,359 --> 00:00:32,640
Welcome to Scribba's intro to NestJS

14
00:00:32,640 --> 00:00:34,480
course. If you're looking to level up

15
00:00:34,480 --> 00:00:36,719
your backend skills, move beyond just

16
00:00:36,719 --> 00:00:38,559
building basic express apps, and

17
00:00:38,559 --> 00:00:40,239
challenge yourself with a more robust

18
00:00:40,239 --> 00:00:42,480
and scalable framework, this course is

19
00:00:42,480 --> 00:00:44,399
for you. Let me go ahead and give you a

20
00:00:44,399 --> 00:00:46,079
quick overview of what Nest is about and

21
00:00:46,079 --> 00:00:47,520
some of the reasons you might want to

22
00:00:47,520 --> 00:00:49,520
consider building with it.

23
00:00:49,520 --> 00:00:51,920
Nest uses classes, decorators, and

24
00:00:51,920 --> 00:00:54,079
TypeScript to help create clean testable

25
00:00:54,079 --> 00:00:56,320
code and provides first class dependency

26
00:00:56,320 --> 00:00:58,320
injection out of the box through its

27
00:00:58,320 --> 00:01:00,879
dependency injection system. One thing

28
00:01:00,879 --> 00:01:03,039
to note though is you can actually make

29
00:01:03,039 --> 00:01:04,960
Nest work with JavaScript 2 if you're

30
00:01:04,960 --> 00:01:06,640
not too familiar with TypeScript just

31
00:01:06,640 --> 00:01:09,439
yet. Nest has similar module and

32
00:01:09,439 --> 00:01:11,600
dependency injection patterns to Angular

33
00:01:11,600 --> 00:01:13,439
and Java Spring Boot. So, if you're

34
00:01:13,439 --> 00:01:15,119
familiar with that, you'll feel right at

35
00:01:15,119 --> 00:01:17,119
home with working with Nest. If you

36
00:01:17,119 --> 00:01:18,640
aren't familiar with either, don't

37
00:01:18,640 --> 00:01:20,159
worry. This course is meant to be

38
00:01:20,159 --> 00:01:21,680
beginner friendly and you will become

39
00:01:21,680 --> 00:01:23,840
more comfortable with it. Anyways, if

40
00:01:23,840 --> 00:01:26,000
you've built APIs with Express, that's

41
00:01:26,000 --> 00:01:28,640
great. Nest actually uses Express under

42
00:01:28,640 --> 00:01:30,640
the hood, so it's compatible with a lot

43
00:01:30,640 --> 00:01:33,119
of Express middleware. Or if you prefer

44
00:01:33,119 --> 00:01:35,200
Fastify, that's an option in Nest as

45
00:01:35,200 --> 00:01:37,360
well. One thing that people love about

46
00:01:37,360 --> 00:01:40,560
Nest is its opinionated architecture. It

47
00:01:40,560 --> 00:01:42,880
organizes features into modules and uses

48
00:01:42,880 --> 00:01:45,119
the dependency injection system to solve

49
00:01:45,119 --> 00:01:47,360
common dependency management problems

50
00:01:47,360 --> 00:01:49,280
you get with node apps just using

51
00:01:49,280 --> 00:01:51,920
express. It does a great job at keeping

52
00:01:51,920 --> 00:01:54,880
things modular and Nesta is great at

53
00:01:54,880 --> 00:01:56,560
building both monoliths and

54
00:01:56,560 --> 00:01:58,159
microservices.

55
00:01:58,159 --> 00:02:00,880
In terms of market demand, although it's

56
00:02:00,880 --> 00:02:03,360
scalable for large applications and that

57
00:02:03,360 --> 00:02:05,280
is a strength of it, it's actually

58
00:02:05,280 --> 00:02:07,520
mainly used in small to medium-siz

59
00:02:07,520 --> 00:02:08,959
companies. So a lot of people think that

60
00:02:08,959 --> 00:02:11,440
it's meant for just enterprise apps and

61
00:02:11,440 --> 00:02:14,080
that's not the case. The usage of it is

62
00:02:14,080 --> 00:02:16,400
just increasing over time and it's

63
00:02:16,400 --> 00:02:18,239
actually become one of the most popular

64
00:02:18,239 --> 00:02:20,640
frameworks in the node ecosystem. Here

65
00:02:20,640 --> 00:02:22,239
are a few companies that have built apps

66
00:02:22,239 --> 00:02:24,800
with Nest. This obviously isn't a full

67
00:02:24,800 --> 00:02:27,680
list, but I want to level with you. I

68
00:02:27,680 --> 00:02:29,440
know a lot of you are probably taking

69
00:02:29,440 --> 00:02:32,080
this course to level up as a back-end

70
00:02:32,080 --> 00:02:34,080
dev and the node ecosystem and just

71
00:02:34,080 --> 00:02:36,400
increase your marketability. We need to

72
00:02:36,400 --> 00:02:38,560
have an honest conversation.

73
00:02:38,560 --> 00:02:41,120
Most aspiring developers are just

74
00:02:41,120 --> 00:02:44,319
building basic express apps. A lot of

75
00:02:44,319 --> 00:02:46,000
people are just going through the same

76
00:02:46,000 --> 00:02:48,400
MS stack tutorial and then you're also

77
00:02:48,400 --> 00:02:50,080
competing with other people that are

78
00:02:50,080 --> 00:02:51,440
going through the same MS stack

79
00:02:51,440 --> 00:02:54,239
tutorials. A lot of backend positions in

80
00:02:54,239 --> 00:02:55,920
web development, especially with the

81
00:02:55,920 --> 00:02:57,680
larger applications, use heavier

82
00:02:57,680 --> 00:03:00,160
frameworks. Nest has a lot of depth to

83
00:03:00,160 --> 00:03:02,159
it. Being able to demonstrate that

84
00:03:02,159 --> 00:03:04,239
you're familiar with and can build

85
00:03:04,239 --> 00:03:05,840
things with a more scalable framework

86
00:03:05,840 --> 00:03:08,239
like Nest looks way better than piecing

87
00:03:08,239 --> 00:03:10,640
together a simple Express app. If you

88
00:03:10,640 --> 00:03:12,480
want to stand out more, you need to do

89
00:03:12,480 --> 00:03:14,480
more. Building things with Nest will

90
00:03:14,480 --> 00:03:16,080
force you to set a higher bar for

91
00:03:16,080 --> 00:03:18,000
yourself and give you confidence in

92
00:03:18,000 --> 00:03:20,480
building more professional applications.

93
00:03:20,480 --> 00:03:22,480
Now, the Nest CLI, which we'll use

94
00:03:22,480 --> 00:03:24,640
later, is really convenient and speeds

95
00:03:24,640 --> 00:03:26,319
up the scaffolding when creating new

96
00:03:26,319 --> 00:03:28,000
features, and you can trust that it

97
00:03:28,000 --> 00:03:29,440
starts you off with the best Nest

98
00:03:29,440 --> 00:03:32,400
conventions. Honestly, after I switched

99
00:03:32,400 --> 00:03:34,319
over to Nest, I gained a renewed

100
00:03:34,319 --> 00:03:36,080
excitement and working in the Node

101
00:03:36,080 --> 00:03:37,920
ecosystem, and I'm really excited to

102
00:03:37,920 --> 00:03:39,360
teach you how to build things with it.

103
00:03:39,360 --> 00:03:42,879
So, let's get started.

104
00:03:42,879 --> 00:03:45,360
In this course, we're building Dev

105
00:03:45,360 --> 00:03:47,440
Match, a simple dating app for

106
00:03:47,440 --> 00:03:50,080
developers. Now, this is meant to be

107
00:03:50,080 --> 00:03:52,319
beginner friendly. So, we'll just be

108
00:03:52,319 --> 00:03:54,080
focused on building out the profile

109
00:03:54,080 --> 00:03:56,319
feature for our dating app. But this

110
00:03:56,319 --> 00:03:58,159
feature alone will allow us to get you

111
00:03:58,159 --> 00:03:59,599
much more comfortable with the

112
00:03:59,599 --> 00:04:01,360
fundamentals and be able to start

113
00:04:01,360 --> 00:04:02,640
building something of your own with

114
00:04:02,640 --> 00:04:05,120
Nest. To start working with Nest, you

115
00:04:05,120 --> 00:04:07,040
should at least be familiar with

116
00:04:07,040 --> 00:04:10,000
JavaScript, preferably TypeScript. If

117
00:04:10,000 --> 00:04:11,360
you're not really familiar with

118
00:04:11,360 --> 00:04:13,280
TypeScript, that's okay. We won't be

119
00:04:13,280 --> 00:04:15,120
diving that deep into TypeScript, and

120
00:04:15,120 --> 00:04:16,720
you'll still be able to learn how to use

121
00:04:16,720 --> 00:04:19,040
Nest. You should also be familiar with

122
00:04:19,040 --> 00:04:21,759
Node. Believe it or not, discovering how

123
00:04:21,759 --> 00:04:24,479
abstractions work underneath instead of

124
00:04:24,479 --> 00:04:27,199
jumping into just relying on it is a

125
00:04:27,199 --> 00:04:30,080
fantastic way to learn them. And before

126
00:04:30,080 --> 00:04:32,479
you jump into building something with

127
00:04:32,479 --> 00:04:34,560
Nest, you should have familiarity with

128
00:04:34,560 --> 00:04:37,040
building personal projects with Express.

129
00:04:37,040 --> 00:04:39,040
Think of this as the next step after you

130
00:04:39,040 --> 00:04:40,880
build a few basic Express apps and

131
00:04:40,880 --> 00:04:42,880
you're familiar with routing. While

132
00:04:42,880 --> 00:04:44,720
Scribba has a ton of JavaScript courses

133
00:04:44,720 --> 00:04:46,320
to get you more familiar with it, I

134
00:04:46,320 --> 00:04:48,320
included specific links to the others to

135
00:04:48,320 --> 00:04:49,759
get you up to speed if you haven't

136
00:04:49,759 --> 00:04:51,360
explored the murky waters of the back

137
00:04:51,360 --> 00:04:53,759
end yet. For the TypeScript course,

138
00:04:53,759 --> 00:04:55,360
going through TypeScript fundamentals

139
00:04:55,360 --> 00:04:57,040
and practicing what you learned there

140
00:04:57,040 --> 00:04:59,360
should be sufficient. At the time of

141
00:04:59,360 --> 00:05:00,720
this recording, you'll need at least

142
00:05:00,720 --> 00:05:02,960
version 20 of Node to run Nest. All

143
00:05:02,960 --> 00:05:04,720
right, now that we got all of that out

144
00:05:04,720 --> 00:05:06,800
of the way, let's finally get started.

145
00:05:06,800 --> 00:05:10,600
I'll see you in the next lesson.

146
00:05:10,639 --> 00:05:12,320
Let's go ahead and set up the initial

147
00:05:12,320 --> 00:05:14,800
scaffolding. Especially if this is your

148
00:05:14,800 --> 00:05:16,880
first time with Nest, I highly recommend

149
00:05:16,880 --> 00:05:19,440
you use Nest CLI for this. Let's install

150
00:05:19,440 --> 00:05:21,360
the CLI and packages we'll need to get

151
00:05:21,360 --> 00:05:23,600
up and running. Also, I just want to

152
00:05:23,600 --> 00:05:25,280
give you a heads up. If you're running

153
00:05:25,280 --> 00:05:27,199
this locally, I highly recommend you

154
00:05:27,199 --> 00:05:29,440
follow the steps in Nest documentation.

155
00:05:29,440 --> 00:05:31,120
When it comes to the CLI, we're going to

156
00:05:31,120 --> 00:05:32,800
tweak our commands so that it plays

157
00:05:32,800 --> 00:05:35,120
nicely within Scrambas environment. But

158
00:05:35,120 --> 00:05:36,880
you can actually just use the commands

159
00:05:36,880 --> 00:05:38,639
we use in this course when working on

160
00:05:38,639 --> 00:05:40,800
your project locally if you want. I just

161
00:05:40,800 --> 00:05:42,240
want to give you a heads up as it'll be

162
00:05:42,240 --> 00:05:44,000
slightly different than what you may see

163
00:05:44,000 --> 00:05:46,080
in the documentation. Let's go ahead and

164
00:05:46,080 --> 00:05:49,400
set up the CLI.

165
00:05:49,600 --> 00:05:52,000
So what this command is going to do is

166
00:05:52,000 --> 00:05:54,160
it's going to temporarily install the

167
00:05:54,160 --> 00:05:56,479
CLI. We're going to create a new project

168
00:05:56,479 --> 00:05:58,639
called dev match. We're going to set the

169
00:05:58,639 --> 00:06:00,880
package manager as mpm. We're going to

170
00:06:00,880 --> 00:06:03,600
skip the git setup and install

171
00:06:03,600 --> 00:06:05,759
everything in the current directory. Let

172
00:06:05,759 --> 00:06:07,280
me go ahead and speed through this for

173
00:06:07,280 --> 00:06:11,199
us. All right, Nest is almost set up. We

174
00:06:11,199 --> 00:06:15,240
just need to install our packages.

175
00:06:15,440 --> 00:06:17,520
Perfect. Let's try booting up our

176
00:06:17,520 --> 00:06:20,520
project.

177
00:06:26,000 --> 00:06:27,919
If you're setting this up locally,

178
00:06:27,919 --> 00:06:29,440
normally you'd be able to just go to

179
00:06:29,440 --> 00:06:32,319
localhost 3000 in the browser and see

180
00:06:32,319 --> 00:06:34,800
hello world. With the way Scrimpa

181
00:06:34,800 --> 00:06:37,039
currently records the browser output, we

182
00:06:37,039 --> 00:06:38,479
would need to tweak this slightly to get

183
00:06:38,479 --> 00:06:40,080
it so that the output is properly

184
00:06:40,080 --> 00:06:42,479
captured and shown to you. Rather than

185
00:06:42,479 --> 00:06:44,319
doing that, since this is a backend

186
00:06:44,319 --> 00:06:46,479
course after all, I'd rather use

187
00:06:46,479 --> 00:06:48,080
Scribba's network tool to be able to

188
00:06:48,080 --> 00:06:50,639
simulate a get request. If you've ever

189
00:06:50,639 --> 00:06:53,039
used Postman, it's similar to that. If

190
00:06:53,039 --> 00:06:54,880
you haven't, I highly recommend you try

191
00:06:54,880 --> 00:06:56,880
Postman out for yourself. It's been an

192
00:06:56,880 --> 00:06:59,039
invaluable tool I've used as I built out

193
00:06:59,039 --> 00:07:02,720
APIs. Let's try it out.

194
00:07:02,720 --> 00:07:05,599
Success. As you can see, we're getting a

195
00:07:05,599 --> 00:07:08,080
status code of 200. Let's check the

196
00:07:08,080 --> 00:07:10,560
response. And we see hello world. We've

197
00:07:10,560 --> 00:07:13,120
officially spun up our first Nest app.

198
00:07:13,120 --> 00:07:14,720
It's that easy to get up and running

199
00:07:14,720 --> 00:07:16,639
locally to start building out features.

200
00:07:16,639 --> 00:07:18,400
Now it's time to start getting you more

201
00:07:18,400 --> 00:07:20,639
comfortable with how Nest works. I'll

202
00:07:20,639 --> 00:07:24,199
see you in the next lesson.

203
00:07:24,479 --> 00:07:26,400
Let's go ahead and create our first

204
00:07:26,400 --> 00:07:28,960
module. Modules are great for organizing

205
00:07:28,960 --> 00:07:30,800
components. They help organize code

206
00:07:30,800 --> 00:07:32,960
that's relevant to a specific feature,

207
00:07:32,960 --> 00:07:35,199
helping to maintain clear boundaries and

208
00:07:35,199 --> 00:07:36,960
better organization.

209
00:07:36,960 --> 00:07:39,039
You could use the CLI to generate all of

210
00:07:39,039 --> 00:07:42,319
the boiler plate for a feature like so.

211
00:07:42,319 --> 00:07:45,199
But as we're learning, let's use the CLI

212
00:07:45,199 --> 00:07:47,440
more selectively to generate what we

213
00:07:47,440 --> 00:07:50,560
need as we go through the lessons. Let's

214
00:07:50,560 --> 00:07:54,520
generate our first module.

215
00:07:55,199 --> 00:07:58,479
So what the CLI just did is it created

216
00:07:58,479 --> 00:08:02,160
our profiles feature in the SRC folder.

217
00:08:02,160 --> 00:08:04,479
As we can see, we have a new profiles

218
00:08:04,479 --> 00:08:06,720
folder. We check it out. We have our

219
00:08:06,720 --> 00:08:09,199
module file and then the CLI

220
00:08:09,199 --> 00:08:11,680
conveniently also added the profiles

221
00:08:11,680 --> 00:08:15,199
module to the imports as well. Let's go

222
00:08:15,199 --> 00:08:17,680
ahead and check out our profiles module

223
00:08:17,680 --> 00:08:20,000
file. As you can see, it's pretty empty.

224
00:08:20,000 --> 00:08:22,479
We haven't really added anything yet.

225
00:08:22,479 --> 00:08:25,599
Let's start populating our feature. The

226
00:08:25,599 --> 00:08:28,319
next step is to create our controller

227
00:08:28,319 --> 00:08:30,720
file. Our controller will contain all of

228
00:08:30,720 --> 00:08:33,360
our routes for the profile feature. We

229
00:08:33,360 --> 00:08:35,440
can actually go ahead and use the CLI to

230
00:08:35,440 --> 00:08:37,440
create our controller file as well. CLI

231
00:08:37,440 --> 00:08:41,000
is really convenient.

232
00:08:41,839 --> 00:08:44,720
So, as you can see, it autopop populated

233
00:08:44,720 --> 00:08:47,680
the profiles module. We can now see that

234
00:08:47,680 --> 00:08:49,360
our controller is being imported

235
00:08:49,360 --> 00:08:51,279
properly. Let's go ahead and open up our

236
00:08:51,279 --> 00:08:54,160
controller file. Now, our controller is

237
00:08:54,160 --> 00:08:56,880
empty by default. And what we're going

238
00:08:56,880 --> 00:08:58,320
to do is we're going to start populating

239
00:08:58,320 --> 00:09:00,000
this manually. and we'll get you some

240
00:09:00,000 --> 00:09:02,800
practice with this. One thing you'll

241
00:09:02,800 --> 00:09:06,080
notice is that it also autogenerated a

242
00:09:06,080 --> 00:09:07,680
spec file where we're going to put our

243
00:09:07,680 --> 00:09:10,080
test for our controller in. Now, we're

244
00:09:10,080 --> 00:09:11,600
not going to be writing test in this

245
00:09:11,600 --> 00:09:13,040
course, but I just wanted to make you

246
00:09:13,040 --> 00:09:16,080
aware that this is also generated, but

247
00:09:16,080 --> 00:09:17,839
there's an interesting little symbol

248
00:09:17,839 --> 00:09:21,519
here. This is called a decorator.

249
00:09:21,519 --> 00:09:23,200
They're basically higher order

250
00:09:23,200 --> 00:09:25,440
functions. If you've never heard of a

251
00:09:25,440 --> 00:09:27,360
higher order function before, let's say

252
00:09:27,360 --> 00:09:30,000
you have a function say hello. A

253
00:09:30,000 --> 00:09:31,839
decorator function will take the say

254
00:09:31,839 --> 00:09:33,760
hello function and do some extra stuff

255
00:09:33,760 --> 00:09:36,240
like printing a line before and after

256
00:09:36,240 --> 00:09:38,480
the main function runs. It just adds

257
00:09:38,480 --> 00:09:40,880
additional behavior to the function.

258
00:09:40,880 --> 00:09:42,880
Decorators aren't currently implemented

259
00:09:42,880 --> 00:09:44,720
in JavaScript, but they've been in

260
00:09:44,720 --> 00:09:47,040
Typescript for a while and are enabled

261
00:09:47,040 --> 00:09:49,040
by setting the experimental decorators

262
00:09:49,040 --> 00:09:52,080
compile option in your TS config file

263
00:09:52,080 --> 00:09:54,800
and have evolved over time. Nest sets

264
00:09:54,800 --> 00:09:56,560
this up automatically, so you don't need

265
00:09:56,560 --> 00:09:59,040
to worry about this, though. The main

266
00:09:59,040 --> 00:10:00,720
thing you need to know is that this is

267
00:10:00,720 --> 00:10:02,399
what using a decorator looks like, and

268
00:10:02,399 --> 00:10:04,640
Nest has a ton of built-in decorators

269
00:10:04,640 --> 00:10:06,880
that make your life easier. We'll be

270
00:10:06,880 --> 00:10:08,399
using some of them in this course and

271
00:10:08,399 --> 00:10:09,839
you'll start to get the hang of using

272
00:10:09,839 --> 00:10:11,360
them by the end of it. So, if they look

273
00:10:11,360 --> 00:10:13,120
intimidating, don't worry about it. You

274
00:10:13,120 --> 00:10:15,360
will get more comfortable with them. In

275
00:10:15,360 --> 00:10:16,959
the next lesson, we're going to finally

276
00:10:16,959 --> 00:10:21,360
set up our routes. I'll see you there.

277
00:10:21,360 --> 00:10:23,600
Finally, it's time to start building out

278
00:10:23,600 --> 00:10:26,079
our routes. Now, you'll notice that I

279
00:10:26,079 --> 00:10:28,000
copied and pasted this in. These are the

280
00:10:28,000 --> 00:10:29,040
routes that we're going to be building

281
00:10:29,040 --> 00:10:31,279
out in this course. Let's start with

282
00:10:31,279 --> 00:10:33,040
setting up the route to return all

283
00:10:33,040 --> 00:10:35,600
dating profiles. So, let's go ahead and

284
00:10:35,600 --> 00:10:38,720
import our get decorator.

285
00:10:38,720 --> 00:10:40,880
And with our get decorator, we're going

286
00:10:40,880 --> 00:10:43,040
to call that on a function we're just

287
00:10:43,040 --> 00:10:45,600
going to call find all.

288
00:10:45,600 --> 00:10:47,680
And we're going to go ahead and return

289
00:10:47,680 --> 00:10:50,399
an empty array. So, we're just returning

290
00:10:50,399 --> 00:10:52,480
an empty array to just test if this is

291
00:10:52,480 --> 00:10:55,519
working. Now, before we do that, let me

292
00:10:55,519 --> 00:10:57,760
go ahead and open this up. So, you'll

293
00:10:57,760 --> 00:11:01,600
see in the runner that everything looks

294
00:11:01,600 --> 00:11:04,240
good. What I want to do is break this to

295
00:11:04,240 --> 00:11:05,839
just show you what happens when we break

296
00:11:05,839 --> 00:11:10,079
it. So, let's go ahead and save it here.

297
00:11:10,079 --> 00:11:11,680
You'll notice that we do get an error in

298
00:11:11,680 --> 00:11:13,519
the runner. So, if you ever are

299
00:11:13,519 --> 00:11:15,519
experiencing issues or your app isn't

300
00:11:15,519 --> 00:11:17,120
doing what you think it's doing, the

301
00:11:17,120 --> 00:11:19,279
runner is a really good first choice to

302
00:11:19,279 --> 00:11:20,959
check just to see if something has gone

303
00:11:20,959 --> 00:11:23,920
wrong. So, let's go back to here and fix

304
00:11:23,920 --> 00:11:27,600
it and test it out. And it looks like

305
00:11:27,600 --> 00:11:30,320
everything is rerendered properly. Now,

306
00:11:30,320 --> 00:11:32,000
let's see if our get request actually

307
00:11:32,000 --> 00:11:34,880
works. Let's go to the network tab, and

308
00:11:34,880 --> 00:11:38,000
we can just make a get request to our

309
00:11:38,000 --> 00:11:42,399
profiles endpoint. And it works. So,

310
00:11:42,399 --> 00:11:44,640
we're getting an empty array and a 200

311
00:11:44,640 --> 00:11:47,760
status code back. Success. Now, we might

312
00:11:47,760 --> 00:11:49,200
want to change the status code in the

313
00:11:49,200 --> 00:11:51,200
future, and Nest provides a way to

314
00:11:51,200 --> 00:11:53,839
easily do that. But for now, we're

315
00:11:53,839 --> 00:11:55,760
getting everything back that we need to,

316
00:11:55,760 --> 00:11:58,560
and we have a working get route. So

317
00:11:58,560 --> 00:12:00,000
right now we're returning an empty

318
00:12:00,000 --> 00:12:02,399
array. We'll be returning data once we

319
00:12:02,399 --> 00:12:04,560
get to the service file where you'll

320
00:12:04,560 --> 00:12:06,480
usually hold most of your business logic

321
00:12:06,480 --> 00:12:08,639
in your app. Think of the controller

322
00:12:08,639 --> 00:12:10,800
layer as deciding what to do based on

323
00:12:10,800 --> 00:12:13,040
the request your API receives, what

324
00:12:13,040 --> 00:12:14,720
functions to call, and allowing your

325
00:12:14,720 --> 00:12:17,120
service layer to decide how to do it. If

326
00:12:17,120 --> 00:12:18,639
this doesn't make sense right now,

327
00:12:18,639 --> 00:12:20,800
that's okay. We're going to practice.

328
00:12:20,800 --> 00:12:22,480
For now, let's just focus on getting

329
00:12:22,480 --> 00:12:24,000
more comfortable with setting up routes

330
00:12:24,000 --> 00:12:25,920
and extracting data from the request

331
00:12:25,920 --> 00:12:28,320
object. Now, I think you're ready for

332
00:12:28,320 --> 00:12:29,600
your first challenge. So, let me go

333
00:12:29,600 --> 00:12:32,320
ahead and reset this. I want you to

334
00:12:32,320 --> 00:12:34,160
recreate our get route and just return

335
00:12:34,160 --> 00:12:36,240
an empty array. When you're done with

336
00:12:36,240 --> 00:12:38,000
the challenge, go ahead and submit it

337
00:12:38,000 --> 00:12:39,519
and then we'll go over it together

338
00:12:39,519 --> 00:12:43,959
afterwards. Good luck.

339
00:12:45,048 --> 00:12:45,760
[sighs]

340
00:12:45,760 --> 00:12:48,000
I hope that went well. So, let's go

341
00:12:48,000 --> 00:12:51,839
ahead and restore our get route.

342
00:12:51,839 --> 00:12:54,480
So, we're going to call get

343
00:12:54,480 --> 00:12:57,040
and then create our find all function.

344
00:12:57,040 --> 00:12:59,120
And that's just going to return an empty

345
00:12:59,120 --> 00:13:01,440
array. Let's go ahead and test it in the

346
00:13:01,440 --> 00:13:04,760
network tab.

347
00:13:05,519 --> 00:13:09,200
And success. So, get routes can often

348
00:13:09,200 --> 00:13:12,079
receive query parameters. So, let's just

349
00:13:12,079 --> 00:13:15,200
go ahead and grab a query parameter to

350
00:13:15,200 --> 00:13:17,360
show you other things Nest can do. So,

351
00:13:17,360 --> 00:13:20,560
we import that here. And then we're

352
00:13:20,560 --> 00:13:23,440
going to go ahead and pass in query. And

353
00:13:23,440 --> 00:13:26,399
let's go ahead and grab age. Age is

354
00:13:26,399 --> 00:13:28,639
going to be a number. And then just to

355
00:13:28,639 --> 00:13:30,079
make sure that we're reading this

356
00:13:30,079 --> 00:13:31,920
correctly, we'll go ahead and just pass

357
00:13:31,920 --> 00:13:34,399
in a single profile with age back to the

358
00:13:34,399 --> 00:13:37,920
client. Now let's test it out.

359
00:13:37,920 --> 00:13:41,040
Say age 25. And success. We're getting

360
00:13:41,040 --> 00:13:44,320
back a 200 with an array, a single

361
00:13:44,320 --> 00:13:47,920
profile, and an age of 25. So we are

362
00:13:47,920 --> 00:13:49,200
going to get a lot of practice in this

363
00:13:49,200 --> 00:13:50,880
course. So let me go ahead and reset

364
00:13:50,880 --> 00:13:52,320
this for you and prepare you for your

365
00:13:52,320 --> 00:13:54,800
new challenge. For this challenge, I

366
00:13:54,800 --> 00:13:56,720
want our get route to expect to receive

367
00:13:56,720 --> 00:13:59,760
a query parameter of location and just

368
00:13:59,760 --> 00:14:01,440
return an array with a single object

369
00:14:01,440 --> 00:14:04,079
with the location passed in just like we

370
00:14:04,079 --> 00:14:08,920
did before. All right, good luck.

371
00:14:09,760 --> 00:14:12,480
I hope that went well. So let's go ahead

372
00:14:12,480 --> 00:14:15,600
and import query

373
00:14:15,600 --> 00:14:18,560
and then we're going to call query here

374
00:14:18,560 --> 00:14:21,120
and we want to grab location

375
00:14:21,120 --> 00:14:23,279
and then location is actually going to

376
00:14:23,279 --> 00:14:27,120
be a string. Now let's pass a profile

377
00:14:27,120 --> 00:14:29,600
with location back to the client and

378
00:14:29,600 --> 00:14:32,720
just make sure that we are properly

379
00:14:32,720 --> 00:14:34,160
receiving the query parameter and

380
00:14:34,160 --> 00:14:36,320
passing it through. Now, let's go ahead

381
00:14:36,320 --> 00:14:37,920
and test this out in our network tool to

382
00:14:37,920 --> 00:14:40,000
see if we are properly handling the

383
00:14:40,000 --> 00:14:43,000
location.

384
00:14:46,560 --> 00:14:48,959
Success. I hope your first challenges

385
00:14:48,959 --> 00:14:51,120
went well for you. If you struggled a

386
00:14:51,120 --> 00:14:52,880
little bit, that's okay. We are going to

387
00:14:52,880 --> 00:14:55,199
get a lot of practice. But that's it for

388
00:14:55,199 --> 00:14:56,880
this lesson. In our next lesson, we're

389
00:14:56,880 --> 00:14:58,160
going to go ahead and handle getting a

390
00:14:58,160 --> 00:15:02,839
single profile. I'll see you there.

391
00:15:03,360 --> 00:15:05,040
In this lesson, we're going to go ahead

392
00:15:05,040 --> 00:15:06,639
and create a route to handle getting a

393
00:15:06,639 --> 00:15:09,600
single profile. So, we are going to need

394
00:15:09,600 --> 00:15:11,360
to grab the ID from the pram. So, let's

395
00:15:11,360 --> 00:15:14,800
go ahead and import that decorator.

396
00:15:14,800 --> 00:15:18,639
And then we are going to call get and

397
00:15:18,639 --> 00:15:22,000
we're going to need to grab the ID.

398
00:15:22,000 --> 00:15:23,440
And let's go ahead and just call this

399
00:15:23,440 --> 00:15:25,680
function find one. And so, we're going

400
00:15:25,680 --> 00:15:30,079
to have a pram with an ID. And then our

401
00:15:30,079 --> 00:15:32,480
ID is just going to be a string. And

402
00:15:32,480 --> 00:15:35,279
just to make sure that we are properly

403
00:15:35,279 --> 00:15:37,680
wh already made a mistake. This is going

404
00:15:37,680 --> 00:15:40,000
to be singular. Just to make sure that

405
00:15:40,000 --> 00:15:42,000
we are properly receiving the ID, we're

406
00:15:42,000 --> 00:15:44,399
going to pass it through and just return

407
00:15:44,399 --> 00:15:46,480
the ID in an object just like we were

408
00:15:46,480 --> 00:15:49,440
returning a profile object. Now let's go

409
00:15:49,440 --> 00:15:51,600
ahead and save it. And then we want to

410
00:15:51,600 --> 00:15:56,279
test it out using our network tool.

411
00:15:57,040 --> 00:15:59,040
And it does look like we are getting a

412
00:15:59,040 --> 00:16:01,120
200 back. This looks promising. and

413
00:16:01,120 --> 00:16:04,079
we're seeing the ID. Perfect. So, our

414
00:16:04,079 --> 00:16:06,560
route is successfully receiving the ID

415
00:16:06,560 --> 00:16:09,279
pram and passing it back to the client.

416
00:16:09,279 --> 00:16:11,199
Now, we want to build up muscle memory.

417
00:16:11,199 --> 00:16:12,959
So, let's go ahead and give you your

418
00:16:12,959 --> 00:16:15,120
challenge. Let me go ahead and clear

419
00:16:15,120 --> 00:16:17,839
this out and let me copy and paste in

420
00:16:17,839 --> 00:16:20,399
your challenge. So, for your challenge,

421
00:16:20,399 --> 00:16:22,399
I simply want you to replicate this.

422
00:16:22,399 --> 00:16:23,600
You're just going to build out a route

423
00:16:23,600 --> 00:16:25,120
to be able to handle getting a single

424
00:16:25,120 --> 00:16:27,839
profile. You are going to look for an ID

425
00:16:27,839 --> 00:16:29,440
prim and then you're just going to go

426
00:16:29,440 --> 00:16:31,040
ahead and return that back to a client

427
00:16:31,040 --> 00:16:33,680
in an object. Don't forget to use the

428
00:16:33,680 --> 00:16:35,920
network tool to test out your code. All

429
00:16:35,920 --> 00:16:39,639
right, good luck.

430
00:16:40,880 --> 00:16:42,959
I hope that went well. So, let's go

431
00:16:42,959 --> 00:16:44,720
ahead and go over the solution. So,

432
00:16:44,720 --> 00:16:47,040
again, we're going to import param

433
00:16:47,040 --> 00:16:49,680
because we want to grab the ID. So our

434
00:16:49,680 --> 00:16:54,399
get is going to receive an ID and then

435
00:16:54,399 --> 00:16:57,600
we'll call this fine one.

436
00:16:57,600 --> 00:17:00,160
We're going to have a pram with an ID

437
00:17:00,160 --> 00:17:02,000
and again that ID is going to be a

438
00:17:02,000 --> 00:17:03,839
string and then we're just going to go

439
00:17:03,839 --> 00:17:07,280
ahead and return an object with that ID.

440
00:17:07,280 --> 00:17:09,360
As always, we want to test out our code.

441
00:17:09,360 --> 00:17:11,839
So let's open up the network tab. Let's

442
00:17:11,839 --> 00:17:15,280
go ahead and pass in a two this time.

443
00:17:15,280 --> 00:17:17,199
Success. Looks like we're getting a two

444
00:17:17,199 --> 00:17:19,679
back. And that's it for getting a single

445
00:17:19,679 --> 00:17:21,600
profile. In the next lesson, we are

446
00:17:21,600 --> 00:17:23,199
going to create a post route to be able

447
00:17:23,199 --> 00:17:27,919
to create a profile. I'll see you there.

448
00:17:27,919 --> 00:17:30,000
It's time to create a route to handle

449
00:17:30,000 --> 00:17:32,320
post requests for creating a profile.

450
00:17:32,320 --> 00:17:35,760
So, let's go ahead and import post up

451
00:17:35,760 --> 00:17:40,160
here. Just start creating it down here.

452
00:17:40,160 --> 00:17:41,919
And so, we are going to use the post

453
00:17:41,919 --> 00:17:43,280
deck creator and we're just going to

454
00:17:43,280 --> 00:17:46,160
call this function create. Now, before

455
00:17:46,160 --> 00:17:48,320
we pull data out of the body, we'll tell

456
00:17:48,320 --> 00:17:50,240
Nest what the data should look like by

457
00:17:50,240 --> 00:17:52,640
creating a data transfer object. Think

458
00:17:52,640 --> 00:17:55,120
of a DTO as a little shape contract for

459
00:17:55,120 --> 00:17:57,440
each request. It lists the properties we

460
00:17:57,440 --> 00:18:00,000
expect. For example, for our profile,

461
00:18:00,000 --> 00:18:01,600
we'll have a name, which is going to be

462
00:18:01,600 --> 00:18:03,200
a string, and a description, which is

463
00:18:03,200 --> 00:18:05,440
going to be a string. We write it as a

464
00:18:05,440 --> 00:18:07,600
class, not just an interface, because

465
00:18:07,600 --> 00:18:10,320
classes stick around at runtime. that

466
00:18:10,320 --> 00:18:13,520
lets Nest validation features pipes read

467
00:18:13,520 --> 00:18:15,520
the class metadata and reject bad

468
00:18:15,520 --> 00:18:17,679
payloads. So let's actually get started

469
00:18:17,679 --> 00:18:18,960
with that. We'll go ahead and create a

470
00:18:18,960 --> 00:18:22,640
DTO file. Typically you will see a DTO

471
00:18:22,640 --> 00:18:25,840
file and a DTO folder. In that DTO

472
00:18:25,840 --> 00:18:27,840
folder, we'll go ahead and create a new

473
00:18:27,840 --> 00:18:31,200
file. We'll call this create profile

474
00:18:31,200 --> 00:18:33,280
DTO. So this is going to be a TypeScript

475
00:18:33,280 --> 00:18:35,600
file where we're just creating a class

476
00:18:35,600 --> 00:18:38,960
and that class is going to have a name

477
00:18:38,960 --> 00:18:41,039
which is a string and a description

478
00:18:41,039 --> 00:18:43,120
which is also a string. Now we need to

479
00:18:43,120 --> 00:18:44,960
hook it up in our controller. So let's

480
00:18:44,960 --> 00:18:47,840
go ahead and import that. Now we want to

481
00:18:47,840 --> 00:18:49,280
grab the body. So we're going to go

482
00:18:49,280 --> 00:18:51,200
ahead and grab the body decorator as

483
00:18:51,200 --> 00:18:54,080
well. So we'll call body here. And we

484
00:18:54,080 --> 00:18:58,000
can just call this create profile DTO.

485
00:18:58,000 --> 00:19:00,480
So we can just return the body here

486
00:19:00,480 --> 00:19:01,760
directly. But I'm going to be a little

487
00:19:01,760 --> 00:19:03,440
bit more explicit to just show that

488
00:19:03,440 --> 00:19:05,120
we're creating a new object which is

489
00:19:05,120 --> 00:19:07,840
going to represent our profile and then

490
00:19:07,840 --> 00:19:09,679
we'll break that down. So let's go ahead

491
00:19:09,679 --> 00:19:12,320
and return an object and then we're

492
00:19:12,320 --> 00:19:13,520
going to have name. We're going to get

493
00:19:13,520 --> 00:19:17,039
that name from the body. And same with

494
00:19:17,039 --> 00:19:18,880
description.

495
00:19:18,880 --> 00:19:20,799
Now at the time of this recording, the

496
00:19:20,799 --> 00:19:22,400
network tool is still being flushed out

497
00:19:22,400 --> 00:19:24,960
in Scribba. So, we can use it for get

498
00:19:24,960 --> 00:19:27,600
requests, but for post, put, and delete

499
00:19:27,600 --> 00:19:29,520
requests, we're going to need to use

500
00:19:29,520 --> 00:19:32,480
curl requests. Now, I actually created a

501
00:19:32,480 --> 00:19:35,039
bash script, which will make this very

502
00:19:35,039 --> 00:19:37,360
easy for you. So, what we have here is

503
00:19:37,360 --> 00:19:40,000
just a script that sends a curl request,

504
00:19:40,000 --> 00:19:41,840
and that's essentially making a request

505
00:19:41,840 --> 00:19:44,080
that's going to hit our API. Now, if

506
00:19:44,080 --> 00:19:45,760
you're comfortable with curl, you'll

507
00:19:45,760 --> 00:19:49,039
notice that I have the -x post, which I

508
00:19:49,039 --> 00:19:51,440
don't think you need in newer versions.

509
00:19:51,440 --> 00:19:53,200
I think it can interpret that this is

510
00:19:53,200 --> 00:19:54,720
going to be a post request based off of

511
00:19:54,720 --> 00:19:56,400
the body that we're sending, but I just

512
00:19:56,400 --> 00:19:58,720
included it to be explicit. And in that

513
00:19:58,720 --> 00:20:00,720
post request, we're sending a body with

514
00:20:00,720 --> 00:20:03,440
a name and a description. Now, you can

515
00:20:03,440 --> 00:20:05,520
change this as you see fit. Now, let me

516
00:20:05,520 --> 00:20:07,520
show you how to test it out. So, we want

517
00:20:07,520 --> 00:20:10,320
to go into our terminal,

518
00:20:10,320 --> 00:20:13,039
and all we're going to do is type bash

519
00:20:13,039 --> 00:20:16,799
and then the name of the file, host.sh.

520
00:20:16,799 --> 00:20:18,320
Now you can see that we're getting a

521
00:20:18,320 --> 00:20:21,360
2011 created and everything looks good,

522
00:20:21,360 --> 00:20:24,160
right? 2011 means created, but this can

523
00:20:24,160 --> 00:20:26,160
be very misleading. So one thing I

524
00:20:26,160 --> 00:20:28,400
notice is we actually should be

525
00:20:28,400 --> 00:20:31,280
receiving the response back and that

526
00:20:31,280 --> 00:20:33,600
should be displayed in the terminal. So

527
00:20:33,600 --> 00:20:35,760
I notice that the content length is

528
00:20:35,760 --> 00:20:37,760
zero. This indicates to me that

529
00:20:37,760 --> 00:20:40,000
something went wrong. Now maybe I

530
00:20:40,000 --> 00:20:42,080
created this bug on purpose or maybe it

531
00:20:42,080 --> 00:20:44,400
was an accident. You'll never know. But

532
00:20:44,400 --> 00:20:46,080
one of the first things that I want to

533
00:20:46,080 --> 00:20:48,720
check out is the runner. Ooh, it looks

534
00:20:48,720 --> 00:20:50,960
like we are not properly importing our

535
00:20:50,960 --> 00:20:53,200
DTO. So, let's go ahead and fix that.

536
00:20:53,200 --> 00:20:55,280
So, you'll notice that I actually put

537
00:20:55,280 --> 00:20:58,320
the file in the DTO folder. So, let's

538
00:20:58,320 --> 00:21:00,559
actually scroll up and we're going to

539
00:21:00,559 --> 00:21:03,280
add the folder. Let's go ahead and try

540
00:21:03,280 --> 00:21:06,240
this again. And now we are successfully

541
00:21:06,240 --> 00:21:08,640
getting the body back. We see a name and

542
00:21:08,640 --> 00:21:10,480
a description. So, we're getting our

543
00:21:10,480 --> 00:21:12,799
profile. Now, usually when you create a

544
00:21:12,799 --> 00:21:15,039
resource, you'll usually see an ID as

545
00:21:15,039 --> 00:21:17,679
well. We haven't actually generated that

546
00:21:17,679 --> 00:21:19,520
yet, so we're not going to return it,

547
00:21:19,520 --> 00:21:21,200
but we'll hook up the logic to create a

548
00:21:21,200 --> 00:21:23,200
new profile soon. I think it's time for

549
00:21:23,200 --> 00:21:24,640
your challenge. So, let me go ahead and

550
00:21:24,640 --> 00:21:27,360
reset this. Let me go ahead and copy and

551
00:21:27,360 --> 00:21:30,240
paste in your challenge. So, all I want

552
00:21:30,240 --> 00:21:32,159
you to do is just replicate what we just

553
00:21:32,159 --> 00:21:34,960
did. You are going to create our route

554
00:21:34,960 --> 00:21:37,360
to be able to handle post requests. You

555
00:21:37,360 --> 00:21:39,600
are going to create a DTO file and in

556
00:21:39,600 --> 00:21:41,360
that DTO file you're going to have a

557
00:21:41,360 --> 00:21:43,039
class with a name and description both

558
00:21:43,039 --> 00:21:44,640
of which are going to be a string and

559
00:21:44,640 --> 00:21:45,840
then you're going to hook that up in

560
00:21:45,840 --> 00:21:47,760
your controller and then return the

561
00:21:47,760 --> 00:21:49,760
body. Don't forget to run the bash

562
00:21:49,760 --> 00:21:52,720
script at the end. Again, it's just bash

563
00:21:52,720 --> 00:21:55,200
space and then the file name. All right,

564
00:21:55,200 --> 00:21:56,720
go ahead and give this a try on your own

565
00:21:56,720 --> 00:22:00,840
and then I'll see you on the other side.

566
00:22:01,200 --> 00:22:03,760
I hope that went well. So, let's go

567
00:22:03,760 --> 00:22:06,640
ahead and get started. Let's start with

568
00:22:06,640 --> 00:22:09,520
creating a new folder. Call it DTO.

569
00:22:09,520 --> 00:22:10,880
We're going to create a new file in that

570
00:22:10,880 --> 00:22:14,080
folder. And we'll call it create profile

571
00:22:14,080 --> 00:22:18,960
DTO. And export a class create profile

572
00:22:18,960 --> 00:22:20,559
DTO.

573
00:22:20,559 --> 00:22:22,159
And the name is going to be a string.

574
00:22:22,159 --> 00:22:24,559
And the description is going to be a

575
00:22:24,559 --> 00:22:27,120
string as well. So we'll need to import

576
00:22:27,120 --> 00:22:29,200
this. So we know we're going to need

577
00:22:29,200 --> 00:22:33,760
host and body. And then let's import

578
00:22:33,760 --> 00:22:39,200
our DTO create profile DTO. And we are

579
00:22:39,200 --> 00:22:40,480
going to import it from the correct

580
00:22:40,480 --> 00:22:44,480
place this time. And I hope that you did

581
00:22:44,480 --> 00:22:46,320
honestly create a bug, you got to

582
00:22:46,320 --> 00:22:48,159
experiment with a runner because in

583
00:22:48,159 --> 00:22:50,080
reality when you do get stumped, when

584
00:22:50,080 --> 00:22:51,679
your code doesn't work and you have to

585
00:22:51,679 --> 00:22:54,320
debug it, you often reinforce the

586
00:22:54,320 --> 00:22:56,559
concept even more. But who knows, maybe

587
00:22:56,559 --> 00:22:58,960
we'll create another bug. So we have our

588
00:22:58,960 --> 00:23:01,840
post decorator and then we're going to

589
00:23:01,840 --> 00:23:04,320
create our create function that'll take

590
00:23:04,320 --> 00:23:07,520
a body and we're going to call this

591
00:23:07,520 --> 00:23:11,039
create profile DTO and map that to the

592
00:23:11,039 --> 00:23:13,520
DTO. All we're going to do is just

593
00:23:13,520 --> 00:23:16,320
return a new object. That name is going

594
00:23:16,320 --> 00:23:18,960
to get the name from the body and the

595
00:23:18,960 --> 00:23:21,200
description from the body as well. So

596
00:23:21,200 --> 00:23:24,720
let's test it out. And success. We are

597
00:23:24,720 --> 00:23:28,720
seeing a 2011 and we are seeing name and

598
00:23:28,720 --> 00:23:30,640
description. And that's it for our post

599
00:23:30,640 --> 00:23:32,080
route. In the next lesson, we're going

600
00:23:32,080 --> 00:23:34,159
to tackle the put route for updating a

601
00:23:34,159 --> 00:23:38,600
profile. I'll see you there.

602
00:23:39,039 --> 00:23:40,640
So, our put route is what we're going to

603
00:23:40,640 --> 00:23:43,200
build out to update a profile. You might

604
00:23:43,200 --> 00:23:45,679
have also heard of patch. Put updates

605
00:23:45,679 --> 00:23:48,159
the entire resource while patch updates

606
00:23:48,159 --> 00:23:50,080
part of the resource. We're not going to

607
00:23:50,080 --> 00:23:52,000
go over patch because going over just

608
00:23:52,000 --> 00:23:54,559
put helps us learn what we need to here.

609
00:23:54,559 --> 00:23:56,240
I just wanted to mention this because

610
00:23:56,240 --> 00:23:58,400
when I was starting out, I often confuse

611
00:23:58,400 --> 00:24:00,720
these two. Something else to keep in

612
00:24:00,720 --> 00:24:02,559
mind with put, it'll typically receive

613
00:24:02,559 --> 00:24:04,880
an ID parameter in the URL and the

614
00:24:04,880 --> 00:24:06,640
properties that it needs to update in

615
00:24:06,640 --> 00:24:08,720
the body. Now, you already know

616
00:24:08,720 --> 00:24:10,400
everything you need to in order to do

617
00:24:10,400 --> 00:24:12,080
this on your own. So, let's go ahead and

618
00:24:12,080 --> 00:24:14,480
jump into the assignment. I actually

619
00:24:14,480 --> 00:24:16,960
created the DTO file for the update

620
00:24:16,960 --> 00:24:19,440
profile for you. You'll just need to

621
00:24:19,440 --> 00:24:21,279
create and export the class with the

622
00:24:21,279 --> 00:24:23,360
matching properties. You can refer to

623
00:24:23,360 --> 00:24:26,240
the create profile DTO as needed. In the

624
00:24:26,240 --> 00:24:28,159
response of your controller, just return

625
00:24:28,159 --> 00:24:30,159
an object with the ID, name, and

626
00:24:30,159 --> 00:24:32,000
description you receive from the request

627
00:24:32,000 --> 00:24:35,120
object. I also created the put shell

628
00:24:35,120 --> 00:24:37,760
script for you. Notice that there is

629
00:24:37,760 --> 00:24:40,240
just a random string here for the ID.

630
00:24:40,240 --> 00:24:41,760
For now, you don't actually have to

631
00:24:41,760 --> 00:24:44,480
change this to a working ID. We are just

632
00:24:44,480 --> 00:24:46,559
focused on reading the request object

633
00:24:46,559 --> 00:24:48,880
and returning the ID, name, and

634
00:24:48,880 --> 00:24:50,960
description back to the client. All

635
00:24:50,960 --> 00:24:52,799
right, I'll let you get to it. Good

636
00:24:52,799 --> 00:24:55,799
luck.

637
00:24:57,520 --> 00:24:59,919
I hope that went well. Let's go ahead

638
00:24:59,919 --> 00:25:01,919
and get started with building out the

639
00:25:01,919 --> 00:25:05,360
DTO class. We're going to export a class

640
00:25:05,360 --> 00:25:08,240
called update profile DTO. And then

641
00:25:08,240 --> 00:25:10,000
that'll have a name, which is a string,

642
00:25:10,000 --> 00:25:12,559
and a description, which is a string.

643
00:25:12,559 --> 00:25:14,720
Let's go back over to the controller.

644
00:25:14,720 --> 00:25:16,960
Now, we're going to need to import put.

645
00:25:16,960 --> 00:25:18,960
It looks like we have pram and body

646
00:25:18,960 --> 00:25:20,799
imported. So, we're going to be able to

647
00:25:20,799 --> 00:25:23,279
get the ID and the body. So, yep, we

648
00:25:23,279 --> 00:25:26,480
just need put. Let's come on down here.

649
00:25:26,480 --> 00:25:31,440
So, put is going to take an ID.

650
00:25:31,440 --> 00:25:33,200
And then we'll just call this function

651
00:25:33,200 --> 00:25:36,640
update. Update is going to take a pram,

652
00:25:36,640 --> 00:25:39,520
which is going to be the ID. And that ID

653
00:25:39,520 --> 00:25:41,440
is going to be a string. And then we're

654
00:25:41,440 --> 00:25:43,679
also going to want to grab the body. And

655
00:25:43,679 --> 00:25:46,080
we'll just call the body update profile

656
00:25:46,080 --> 00:25:47,840
DTO.

657
00:25:47,840 --> 00:25:52,279
And so we do need to import this.

658
00:25:53,600 --> 00:25:56,159
And then we're just going to return a

659
00:25:56,159 --> 00:25:58,159
new object.

660
00:25:58,159 --> 00:25:59,760
And it's going to have the ID. And you

661
00:25:59,760 --> 00:26:00,880
know what? We're just going to spread

662
00:26:00,880 --> 00:26:03,919
the body in. That should do it. Let's go

663
00:26:03,919 --> 00:26:06,080
ahead and test it out.

664
00:26:06,080 --> 00:26:08,559
So we are just going to write bash

665
00:26:08,559 --> 00:26:10,400
put.sh.

666
00:26:10,400 --> 00:26:13,600
And success. We are getting an object

667
00:26:13,600 --> 00:26:16,480
with the ID, name, and description. And

668
00:26:16,480 --> 00:26:18,159
that's it for the put route. In the next

669
00:26:18,159 --> 00:26:20,559
lesson, we'll go over delete. I'll see

670
00:26:20,559 --> 00:26:23,720
you there.

671
00:26:23,760 --> 00:26:26,240
Delete routes typically take an ID as a

672
00:26:26,240 --> 00:26:28,880
parameter and return a 204 status code

673
00:26:28,880 --> 00:26:31,760
on successful deletion. Up until now,

674
00:26:31,760 --> 00:26:33,760
Nest has conveniently taken care of

675
00:26:33,760 --> 00:26:35,440
sending the correct status code back to

676
00:26:35,440 --> 00:26:37,840
the client. Unfortunately, it won't be

677
00:26:37,840 --> 00:26:40,480
as simple with the delete request. If we

678
00:26:40,480 --> 00:26:42,640
just return in the delete controller,

679
00:26:42,640 --> 00:26:44,960
Nest will default to a 200. So in

680
00:26:44,960 --> 00:26:46,880
situations like this where we want to

681
00:26:46,880 --> 00:26:48,400
control the status code that we're

682
00:26:48,400 --> 00:26:50,720
returning, Nest provides a convenient

683
00:26:50,720 --> 00:26:53,120
way to do that. I'll go ahead and set up

684
00:26:53,120 --> 00:26:54,960
the delete decorator for you so that I

685
00:26:54,960 --> 00:26:57,039
can show you how this works. So we're

686
00:26:57,039 --> 00:26:58,240
going to need to import three

687
00:26:58,240 --> 00:27:00,320
decorators.

688
00:27:00,320 --> 00:27:06,240
Delete HTTP code and HTTP status. Now

689
00:27:06,240 --> 00:27:09,360
let's come on down here. So we are going

690
00:27:09,360 --> 00:27:13,200
to expect an ID parameter and then for

691
00:27:13,200 --> 00:27:16,000
now no matter what we are going to use

692
00:27:16,000 --> 00:27:19,600
HTTP code to send a status more

693
00:27:19,600 --> 00:27:21,919
specifically we're going to go ahead and

694
00:27:21,919 --> 00:27:25,520
send an okay status which is just a 200

695
00:27:25,520 --> 00:27:27,279
and we can just call this function

696
00:27:27,279 --> 00:27:29,520
remove.

697
00:27:29,520 --> 00:27:32,240
So we're going to have an ID pram

698
00:27:32,240 --> 00:27:34,400
and then that is going to be a string.

699
00:27:34,400 --> 00:27:35,840
We're not going to use that just yet,

700
00:27:35,840 --> 00:27:37,120
but we're actually going to use it later

701
00:27:37,120 --> 00:27:39,679
in the course. Now, this should send

702
00:27:39,679 --> 00:27:42,400
back a 200. We don't necessarily need

703
00:27:42,400 --> 00:27:45,679
HTTP status to set the status to be 200

704
00:27:45,679 --> 00:27:47,279
because without it, it'll default to

705
00:27:47,279 --> 00:27:49,120
200, but I'm including it because we'll

706
00:27:49,120 --> 00:27:52,240
need to send a status code of 204. Let's

707
00:27:52,240 --> 00:27:54,000
go ahead and do a curl request to test

708
00:27:54,000 --> 00:27:56,240
this out. So, you'll notice we do have a

709
00:27:56,240 --> 00:27:59,360
shell script here. This ID can be any ID

710
00:27:59,360 --> 00:28:01,279
for now, but let's go ahead and test

711
00:28:01,279 --> 00:28:05,520
this out, and we should get back a 200.

712
00:28:06,640 --> 00:28:09,279
Success. It's working. Now, for our

713
00:28:09,279 --> 00:28:10,960
purpose, this doesn't really accomplish

714
00:28:10,960 --> 00:28:12,799
our goal. Remember, we want to send back

715
00:28:12,799 --> 00:28:15,440
a status code of 204. That's your

716
00:28:15,440 --> 00:28:17,760
assignment.

717
00:28:17,760 --> 00:28:19,840
Looking up documentation is always a

718
00:28:19,840 --> 00:28:21,440
healthy thing to practice. So, that's

719
00:28:21,440 --> 00:28:23,440
what I want you to do. Go ahead and look

720
00:28:23,440 --> 00:28:27,600
up what the HTTP 204 response is on MDN

721
00:28:27,600 --> 00:28:29,279
and see if you can then figure out what

722
00:28:29,279 --> 00:28:32,559
property on HTTP status represents a

723
00:28:32,559 --> 00:28:35,440
status code of 204. Let me go ahead and

724
00:28:35,440 --> 00:28:39,039
paste a challenge text in here for you.

725
00:28:39,039 --> 00:28:40,880
So change it to the proper status code

726
00:28:40,880 --> 00:28:45,720
and don't forget to test it. Good luck.

727
00:28:47,200 --> 00:28:49,440
I hope that went well. So, what we're

728
00:28:49,440 --> 00:28:52,799
looking for is no content. Let's go

729
00:28:52,799 --> 00:28:56,440
ahead and test this out.

730
00:28:58,240 --> 00:29:00,000
And there we go. We're getting back a

731
00:29:00,000 --> 00:29:01,520
204.

732
00:29:01,520 --> 00:29:03,760
Just a quick note, it's pretty common to

733
00:29:03,760 --> 00:29:06,240
serve back a 204 regardless if the

734
00:29:06,240 --> 00:29:08,320
profile being requested to be deleted is

735
00:29:08,320 --> 00:29:10,720
found or not. When we go over exceptions

736
00:29:10,720 --> 00:29:12,559
later in the course, I'll have you

737
00:29:12,559 --> 00:29:14,559
practice serving up a 404 when the

738
00:29:14,559 --> 00:29:16,240
profile isn't found with the delete

739
00:29:16,240 --> 00:29:18,159
route. That's just meant to give you

740
00:29:18,159 --> 00:29:20,559
more practice with handling exceptions.

741
00:29:20,559 --> 00:29:22,399
But that pretty much covers most of the

742
00:29:22,399 --> 00:29:24,000
decorators that you're going to use in

743
00:29:24,000 --> 00:29:26,080
the controller for your first Nest app.

744
00:29:26,080 --> 00:29:28,080
As your app grows, you'll likely use

745
00:29:28,080 --> 00:29:30,320
more built-in decorators. And for that,

746
00:29:30,320 --> 00:29:32,640
Nest docs will serve you well. We'll

747
00:29:32,640 --> 00:29:34,399
come back to the controller layer later,

748
00:29:34,399 --> 00:29:36,080
but for now, I think we've covered

749
00:29:36,080 --> 00:29:38,240
enough of the basics. Let's move on to

750
00:29:38,240 --> 00:29:40,880
the service layer.

751
00:29:40,880 --> 00:29:43,039
Here's

752
00:29:43,039 --> 00:29:45,760
a diagram of what a simple Nest app

753
00:29:45,760 --> 00:29:48,000
might look like. So we have a root

754
00:29:48,000 --> 00:29:49,919
application and then we have different

755
00:29:49,919 --> 00:29:52,399
features. We have the O feature, profile

756
00:29:52,399 --> 00:29:54,559
feature, and chat feature. Right now

757
00:29:54,559 --> 00:29:56,720
we're building out the profile feature.

758
00:29:56,720 --> 00:29:59,600
And in our profile feature, we have a

759
00:29:59,600 --> 00:30:01,679
module file, a controller file, and a

760
00:30:01,679 --> 00:30:04,320
service file. So our profile module

761
00:30:04,320 --> 00:30:06,159
handles a lot of the imports for a clean

762
00:30:06,159 --> 00:30:08,559
dependency injection. In our controller

763
00:30:08,559 --> 00:30:10,720
file, we set up all of our routes.

764
00:30:10,720 --> 00:30:12,960
Controllers are meant to handle HTTP

765
00:30:12,960 --> 00:30:15,039
requests and they delegate more complex

766
00:30:15,039 --> 00:30:17,200
things to providers. We're primarily

767
00:30:17,200 --> 00:30:18,559
going to be going over one of the most

768
00:30:18,559 --> 00:30:20,320
common providers you'll be working with,

769
00:30:20,320 --> 00:30:22,720
services. The service layer is where

770
00:30:22,720 --> 00:30:23,840
you're going to put a lot of your

771
00:30:23,840 --> 00:30:26,320
business logic. So, in our app, our

772
00:30:26,320 --> 00:30:28,240
controller handles the requests and our

773
00:30:28,240 --> 00:30:29,760
service handles data storage and

774
00:30:29,760 --> 00:30:31,760
retrieval. The service layer can

775
00:30:31,760 --> 00:30:33,279
certainly do more than that, but that's

776
00:30:33,279 --> 00:30:34,480
what we're going to use it for with our

777
00:30:34,480 --> 00:30:36,720
profile feature. So let's go ahead and

778
00:30:36,720 --> 00:30:39,200
set up our first service. We actually

779
00:30:39,200 --> 00:30:43,039
used an CLI to generate the service.

780
00:30:43,039 --> 00:30:46,399
All right, let's see what was created.

781
00:30:46,399 --> 00:30:48,720
So it looks like we have a new spec file

782
00:30:48,720 --> 00:30:50,159
and service file. We're not going to be

783
00:30:50,159 --> 00:30:51,840
doing anything with the spec file, which

784
00:30:51,840 --> 00:30:52,960
is just going to house a lot of our

785
00:30:52,960 --> 00:30:55,120
automated tests. But let's take a look

786
00:30:55,120 --> 00:30:57,120
at the service file. Notice the

787
00:30:57,120 --> 00:31:00,080
injectable decorator above the class.

788
00:31:00,080 --> 00:31:02,399
This enables our service class when

789
00:31:02,399 --> 00:31:05,120
imported and used elsewhere to create a

790
00:31:05,120 --> 00:31:07,360
new instance of it or reuse an already

791
00:31:07,360 --> 00:31:09,440
created one. So you don't have to create

792
00:31:09,440 --> 00:31:11,600
a new instance of it manually. Nest

793
00:31:11,600 --> 00:31:14,080
handles this for you. Now the goal of

794
00:31:14,080 --> 00:31:16,080
this course is to just teach Nest

795
00:31:16,080 --> 00:31:18,880
concepts, not use an OM or an object

796
00:31:18,880 --> 00:31:20,799
relational mapper for interacting with a

797
00:31:20,799 --> 00:31:23,120
database. So while normally you'd store

798
00:31:23,120 --> 00:31:24,960
this information in your database, we're

799
00:31:24,960 --> 00:31:26,880
going to store our data in our service

800
00:31:26,880 --> 00:31:28,480
class for now. Let me go ahead and copy

801
00:31:28,480 --> 00:31:31,279
and paste that in. And now let me go

802
00:31:31,279 --> 00:31:33,039
ahead and import something to be able to

803
00:31:33,039 --> 00:31:35,840
create random IDs for us.

804
00:31:35,840 --> 00:31:38,720
The random UYU ID method is just used to

805
00:31:38,720 --> 00:31:40,720
create a unique ID and is part of Node's

806
00:31:40,720 --> 00:31:44,159
built-in crypto module. It's not 100%

807
00:31:44,159 --> 00:31:45,760
guaranteed to be unique, but if you got

808
00:31:45,760 --> 00:31:48,080
it to generate two of the same IDs, you

809
00:31:48,080 --> 00:31:49,679
are one of the luckiest people in the

810
00:31:49,679 --> 00:31:52,399
world. It's pretty unique. Now, let's go

811
00:31:52,399 --> 00:31:53,600
ahead and create the function that's

812
00:31:53,600 --> 00:31:55,200
going to get and return all of our

813
00:31:55,200 --> 00:31:57,919
profiles.

814
00:31:57,919 --> 00:32:00,960
Let's call this find all. And then this

815
00:32:00,960 --> 00:32:03,360
is just going to return our profiles

816
00:32:03,360 --> 00:32:05,600
array. Now let's go ahead and hook this

817
00:32:05,600 --> 00:32:07,440
up in our controller and finally return

818
00:32:07,440 --> 00:32:10,480
a list of profiles.

819
00:32:10,480 --> 00:32:12,799
So first let's go ahead and import our

820
00:32:12,799 --> 00:32:15,360
service. Now we're going to add it to

821
00:32:15,360 --> 00:32:16,799
the controller class through the

822
00:32:16,799 --> 00:32:19,799
constructor.

823
00:32:29,440 --> 00:32:31,279
So right now we're just returning an

824
00:32:31,279 --> 00:32:33,039
empty array. Let's go ahead and actually

825
00:32:33,039 --> 00:32:37,240
return the list of our profiles.

826
00:32:40,159 --> 00:32:45,240
And as always, we want to test this out.

827
00:32:46,720 --> 00:32:49,440
So far so good. We're getting a 200. And

828
00:32:49,440 --> 00:32:52,960
we see our profiles. We have Brianna,

829
00:32:52,960 --> 00:32:55,840
Jasper, and Leo. At last, we get to

830
00:32:55,840 --> 00:32:58,399
build out a working profiles feature. In

831
00:32:58,399 --> 00:33:00,080
the next lesson, let's handle getting

832
00:33:00,080 --> 00:33:03,919
just a single profile.

833
00:33:03,919 --> 00:33:05,519
All right, it's time to get your hands

834
00:33:05,519 --> 00:33:07,840
dirty. Using what you just learned in

835
00:33:07,840 --> 00:33:10,399
the last lesson, I want you to create

836
00:33:10,399 --> 00:33:12,559
the service method for getting a single

837
00:33:12,559 --> 00:33:15,120
profile and have the proper route in the

838
00:33:15,120 --> 00:33:16,880
controller return the result of that

839
00:33:16,880 --> 00:33:19,039
method. Remember, we're generating

840
00:33:19,039 --> 00:33:21,120
unique IDs every time we spin this app

841
00:33:21,120 --> 00:33:24,159
up. So, you'll need to get the current

842
00:33:24,159 --> 00:33:26,240
list of profiles in order to get an ID

843
00:33:26,240 --> 00:33:29,120
that exists. You can use the network tab

844
00:33:29,120 --> 00:33:31,039
to be able to do that. And you just want

845
00:33:31,039 --> 00:33:32,799
to hit this route right here to get all

846
00:33:32,799 --> 00:33:35,679
of your profiles. Once you have that ID,

847
00:33:35,679 --> 00:33:37,600
you can use the network tool to then

848
00:33:37,600 --> 00:33:40,480
make a get request with the ID as a

849
00:33:40,480 --> 00:33:42,799
parameter. So, here is our slug to get

850
00:33:42,799 --> 00:33:45,120
all the profiles. Grab an ID from this.

851
00:33:45,120 --> 00:33:47,120
And then we're going to get a single

852
00:33:47,120 --> 00:33:49,519
profile and this is going to be used to

853
00:33:49,519 --> 00:33:52,000
test our newly created service method

854
00:33:52,000 --> 00:33:53,840
and make sure that we hooked it up in

855
00:33:53,840 --> 00:33:56,399
the controller successfully. Also, don't

856
00:33:56,399 --> 00:33:57,919
worry about handling the case where

857
00:33:57,919 --> 00:33:59,760
there isn't a matching profile with the

858
00:33:59,760 --> 00:34:02,000
ID given to us. We're going to go over

859
00:34:02,000 --> 00:34:04,559
how to handle that in upcoming lessons.

860
00:34:04,559 --> 00:34:06,559
For now, assume we're going to be given

861
00:34:06,559 --> 00:34:08,960
an ID that does exist. So, just test

862
00:34:08,960 --> 00:34:11,599
with that. And for your convenience, I

863
00:34:11,599 --> 00:34:14,879
went ahead and just pasted the challenge

864
00:34:14,879 --> 00:34:16,639
steps. Just make sure that you complete

865
00:34:16,639 --> 00:34:18,639
them. You can check back if you forget,

866
00:34:18,639 --> 00:34:20,399
but you know everything that you need to

867
00:34:20,399 --> 00:34:22,320
in order to solve this challenge. So,

868
00:34:22,320 --> 00:34:23,760
I'll let you get to it and I'll see you

869
00:34:23,760 --> 00:34:26,399
on the other side.

870
00:34:26,399 --> 00:34:28,720
I hope that went well. Let's go ahead

871
00:34:28,720 --> 00:34:31,679
and jump into our service file. So, we

872
00:34:31,679 --> 00:34:33,040
already have the method to be able to

873
00:34:33,040 --> 00:34:35,679
get all of the profiles, but we're going

874
00:34:35,679 --> 00:34:37,839
to have to think through how we're going

875
00:34:37,839 --> 00:34:40,159
to execute with JavaScript just a little

876
00:34:40,159 --> 00:34:41,679
bit more thoroughly. It's going to be a

877
00:34:41,679 --> 00:34:43,440
little bit different, but if you're

878
00:34:43,440 --> 00:34:44,720
comfortable with your fundamentals with

879
00:34:44,720 --> 00:34:45,919
JavaScript, it should have been no

880
00:34:45,919 --> 00:34:48,399
problem at all. Let's go ahead and call

881
00:34:48,399 --> 00:34:52,000
this fine one. Fine one is going to

882
00:34:52,000 --> 00:34:55,119
going to take a ID, which is going to be

883
00:34:55,119 --> 00:34:58,320
a string. And then we want to just

884
00:34:58,320 --> 00:35:02,160
return a single profile. So let's go

885
00:35:02,160 --> 00:35:04,720
ahead and use the find method to do

886
00:35:04,720 --> 00:35:09,119
that. And we are going to get a profile.

887
00:35:09,119 --> 00:35:11,440
Let me just move this.

888
00:35:11,440 --> 00:35:13,920
And whoops.

889
00:35:13,920 --> 00:35:19,440
We want to match the profile ID of our

890
00:35:19,440 --> 00:35:23,920
current iteration with the ID that we

891
00:35:23,920 --> 00:35:26,640
are given here. And once that matches,

892
00:35:26,640 --> 00:35:29,440
we'll go ahead and just return that

893
00:35:29,440 --> 00:35:31,760
result from our find. And that should

894
00:35:31,760 --> 00:35:33,280
give us what we want. So let's go ahead

895
00:35:33,280 --> 00:35:36,640
and save this and then go on over to our

896
00:35:36,640 --> 00:35:39,839
controller. Right now we are just

897
00:35:39,839 --> 00:35:41,920
returning the ID that we get from the

898
00:35:41,920 --> 00:35:43,680
pram. So we're going to have to change

899
00:35:43,680 --> 00:35:46,720
that. Now we already imported our

900
00:35:46,720 --> 00:35:49,520
service. So we can go ahead and just

901
00:35:49,520 --> 00:35:55,040
type this profile service find one. And

902
00:35:55,040 --> 00:35:58,000
don't forget to pass in the ID and that

903
00:35:58,000 --> 00:36:00,480
should give us what we want. So in order

904
00:36:00,480 --> 00:36:02,560
to test this, you could have gotten a

905
00:36:02,560 --> 00:36:04,240
unique ID before you started writing

906
00:36:04,240 --> 00:36:07,359
this. That's fine. But we mainly need it

907
00:36:07,359 --> 00:36:10,079
for when we're going to be working with

908
00:36:10,079 --> 00:36:12,400
trying to get a single profile. So I'm

909
00:36:12,400 --> 00:36:14,960
just going to click send to give us our

910
00:36:14,960 --> 00:36:18,560
new profiles. Uh let's go ahead and grab

911
00:36:18,560 --> 00:36:21,119
Jasper. So we're going to grab this ID.

912
00:36:21,119 --> 00:36:22,640
We're going to copy and paste it just

913
00:36:22,640 --> 00:36:26,240
like this. And then we are going to just

914
00:36:26,240 --> 00:36:29,119
enter that into the URL just like that.

915
00:36:29,119 --> 00:36:33,760
So we are looking for specific profile

916
00:36:33,760 --> 00:36:35,680
and that should give us back the entire

917
00:36:35,680 --> 00:36:38,720
object, the entire profile. There we go.

918
00:36:38,720 --> 00:36:40,800
There's Jasper. That's all there is to

919
00:36:40,800 --> 00:36:42,720
it. Now you're going to get some more

920
00:36:42,720 --> 00:36:44,720
practice with building service methods

921
00:36:44,720 --> 00:36:46,480
and even just refreshing some of your

922
00:36:46,480 --> 00:36:48,000
JavaScript fundamentals if you're a

923
00:36:48,000 --> 00:36:49,920
little bit rusty. All right, I'll see

924
00:36:49,920 --> 00:36:53,400
you in the next lesson.

925
00:36:53,440 --> 00:36:56,320
All right, it's time to create a profile

926
00:36:56,320 --> 00:36:58,640
and actually create a profile, not just

927
00:36:58,640 --> 00:37:01,040
return the body that we're sending. So,

928
00:37:01,040 --> 00:37:04,160
we're going to hook up the functionality

929
00:37:04,160 --> 00:37:07,680
in our service layer. And I'll kind of

930
00:37:07,680 --> 00:37:09,599
just go over some of the steps. You can

931
00:37:09,599 --> 00:37:12,560
actually see them right here. They are

932
00:37:12,560 --> 00:37:15,200
pretty long. Don't let this intimidate

933
00:37:15,200 --> 00:37:17,680
you. The code is actually very minimal,

934
00:37:17,680 --> 00:37:20,400
and I'll show you that as well. But I

935
00:37:20,400 --> 00:37:23,040
just wanted to be very clear about this

936
00:37:23,040 --> 00:37:24,800
and give you what you need to be able to

937
00:37:24,800 --> 00:37:26,720
tackle this challenge. I'm very

938
00:37:26,720 --> 00:37:27,760
confident that you're going to be able

939
00:37:27,760 --> 00:37:30,079
to do it. So, let's go over some of

940
00:37:30,079 --> 00:37:32,480
this. Uh, so essentially, you are going

941
00:37:32,480 --> 00:37:36,480
to be creating a function in the service

942
00:37:36,480 --> 00:37:38,160
file. We'll actually open that. We have

943
00:37:38,160 --> 00:37:39,599
it right here. So, you're going to

944
00:37:39,599 --> 00:37:41,599
create a new function. Uh, you could

945
00:37:41,599 --> 00:37:43,040
just call it create or whatever you

946
00:37:43,040 --> 00:37:45,440
want. And it'll take the body of the

947
00:37:45,440 --> 00:37:47,200
post request as a parameter, which will

948
00:37:47,200 --> 00:37:48,960
be the body that we're getting in the

949
00:37:48,960 --> 00:37:51,680
controller. It needs to create a new

950
00:37:51,680 --> 00:37:54,000
profile and add it to the profiles

951
00:37:54,000 --> 00:37:57,119
array. Remember, each profile has an ID,

952
00:37:57,119 --> 00:37:59,520
a name, and a description. And also,

953
00:37:59,520 --> 00:38:01,280
it's good to remember that the backend

954
00:38:01,280 --> 00:38:03,359
is where you'll typically create IDs for

955
00:38:03,359 --> 00:38:05,839
new resources, not the client. You'll

956
00:38:05,839 --> 00:38:08,640
notice that in the original array, we're

957
00:38:08,640 --> 00:38:11,520
using random UU ID to do that. So, you

958
00:38:11,520 --> 00:38:13,920
can utilize that as well. We'll also

959
00:38:13,920 --> 00:38:16,480
want to return the new profile we've

960
00:38:16,480 --> 00:38:19,119
created to the controller and have that

961
00:38:19,119 --> 00:38:22,720
return it as a response in the client.

962
00:38:22,720 --> 00:38:24,640
So, right now, we're just returning the

963
00:38:24,640 --> 00:38:27,040
body. We're actually going to need to

964
00:38:27,040 --> 00:38:28,640
call the new method that we create in

965
00:38:28,640 --> 00:38:30,800
the service file and then return the

966
00:38:30,800 --> 00:38:33,040
result of that. Now, once you've hooked

967
00:38:33,040 --> 00:38:36,720
that up successfully, don't forget that

968
00:38:36,720 --> 00:38:40,000
in the terminal, we can just call, let's

969
00:38:40,000 --> 00:38:42,160
see, where is it? We can just call the

970
00:38:42,160 --> 00:38:46,320
post sh file and that will essentially

971
00:38:46,320 --> 00:38:49,359
hit our create route and that's going to

972
00:38:49,359 --> 00:38:52,960
make a curl request to our post route.

973
00:38:52,960 --> 00:38:55,520
Now, you don't have to change anything,

974
00:38:55,520 --> 00:38:58,160
but if you want, you can change the name

975
00:38:58,160 --> 00:39:00,560
and description to play around with it.

976
00:39:00,560 --> 00:39:03,280
and you'll see your profile reflect

977
00:39:03,280 --> 00:39:05,359
whatever you choose to add for the name

978
00:39:05,359 --> 00:39:07,760
and description. I like to customize

979
00:39:07,760 --> 00:39:09,440
things like this. I think it kind of

980
00:39:09,440 --> 00:39:12,720
breaks me away from the monotonous flow

981
00:39:12,720 --> 00:39:14,640
of just going through lesson after

982
00:39:14,640 --> 00:39:16,320
lesson after lesson and it gets me to

983
00:39:16,320 --> 00:39:18,240
critically think on my own. So change

984
00:39:18,240 --> 00:39:19,599
some things, break some things,

985
00:39:19,599 --> 00:39:20,960
experiment. I think that's always

986
00:39:20,960 --> 00:39:23,040
healthy. But I would keep the changes

987
00:39:23,040 --> 00:39:24,720
minimal at first until you actually

988
00:39:24,720 --> 00:39:26,000
solve the challenge and then you could

989
00:39:26,000 --> 00:39:28,800
play around with it afterwards. So when

990
00:39:28,800 --> 00:39:31,680
you call the bash script uh you will get

991
00:39:31,680 --> 00:39:34,960
a response with a 2011 and it will have

992
00:39:34,960 --> 00:39:37,680
the same response body as when we tried

993
00:39:37,680 --> 00:39:40,240
to retrieve a single profile. So it's

994
00:39:40,240 --> 00:39:42,320
going to have the same structure. And so

995
00:39:42,320 --> 00:39:43,839
again that structure is just going to be

996
00:39:43,839 --> 00:39:45,920
an object with the ID, name, and

997
00:39:45,920 --> 00:39:48,240
description. After you get the response

998
00:39:48,240 --> 00:39:50,880
from the post request, go ahead and just

999
00:39:50,880 --> 00:39:53,200
double check that it exists by making a

1000
00:39:53,200 --> 00:39:55,359
get request of the profile. Now that you

1001
00:39:55,359 --> 00:39:57,440
have the ID, we use the network tab to

1002
00:39:57,440 --> 00:39:59,599
do that. And if you want to see if your

1003
00:39:59,599 --> 00:40:01,680
profile is added, you can actually just

1004
00:40:01,680 --> 00:40:05,200
delete this and make a new request here

1005
00:40:05,200 --> 00:40:08,320
to actually see it added to our array.

1006
00:40:08,320 --> 00:40:11,680
Or you can just type in the ID as well

1007
00:40:11,680 --> 00:40:14,320
to get a single profile because in our

1008
00:40:14,320 --> 00:40:16,079
curl request, we're going to get a

1009
00:40:16,079 --> 00:40:18,000
response that actually gives us the ID

1010
00:40:18,000 --> 00:40:20,320
of our newly created profile. It's up to

1011
00:40:20,320 --> 00:40:22,480
you how you want to double check. Now

1012
00:40:22,480 --> 00:40:24,320
you know everything that you need to in

1013
00:40:24,320 --> 00:40:25,839
order to get started. Let's go ahead and

1014
00:40:25,839 --> 00:40:27,119
go back to the controller file. And

1015
00:40:27,119 --> 00:40:29,599
again, you have these steps and a couple

1016
00:40:29,599 --> 00:40:31,200
things to test that it is working

1017
00:40:31,200 --> 00:40:33,440
successfully. And don't worry, we're

1018
00:40:33,440 --> 00:40:34,560
going to go over this challenge

1019
00:40:34,560 --> 00:40:36,800
together, the solution after you tackle

1020
00:40:36,800 --> 00:40:39,040
the challenge on your own. So have fun

1021
00:40:39,040 --> 00:40:40,960
with it. All right, I'll let you get to

1022
00:40:40,960 --> 00:40:44,800
it and I'll see you on the other side.

1023
00:40:44,800 --> 00:40:46,800
I hope you had fun. All right, let's go

1024
00:40:46,800 --> 00:40:49,200
ahead and jump into the service file.

1025
00:40:49,200 --> 00:40:51,280
So, we're going to need to create a new

1026
00:40:51,280 --> 00:40:54,560
function. Before we do that, let's go

1027
00:40:54,560 --> 00:40:56,640
ahead and import the type from our

1028
00:40:56,640 --> 00:40:59,839
create profile DTO. Now, let's scroll

1029
00:40:59,839 --> 00:41:02,240
down and we are going to create our

1030
00:41:02,240 --> 00:41:05,280
create function. So, that I'm just going

1031
00:41:05,280 --> 00:41:07,280
to call what we're receiving and be

1032
00:41:07,280 --> 00:41:11,119
consistent with it. Create profile DTO.

1033
00:41:11,119 --> 00:41:14,640
And this is why we imported the type. So

1034
00:41:14,640 --> 00:41:17,359
now let's go ahead and just create an

1035
00:41:17,359 --> 00:41:19,599
object that's going to represent our

1036
00:41:19,599 --> 00:41:23,280
newly created profile and that is going

1037
00:41:23,280 --> 00:41:25,520
to have an ID. We're going to use random

1038
00:41:25,520 --> 00:41:27,920
UYU ID to be able to create that. And

1039
00:41:27,920 --> 00:41:30,000
then we are just going to spread the

1040
00:41:30,000 --> 00:41:32,319
rest of the body which is going to

1041
00:41:32,319 --> 00:41:34,880
contain the name and the description in

1042
00:41:34,880 --> 00:41:37,440
our new object. And then we have our

1043
00:41:37,440 --> 00:41:39,680
created profile but now we need to add

1044
00:41:39,680 --> 00:41:44,000
it to the array. So, we are just going

1045
00:41:44,000 --> 00:41:46,880
to push it and then we'll go ahead and

1046
00:41:46,880 --> 00:41:48,400
return the create a profile because we

1047
00:41:48,400 --> 00:41:50,079
want to go ahead and return that as a

1048
00:41:50,079 --> 00:41:52,800
response to let the user know that this

1049
00:41:52,800 --> 00:41:55,119
was the profile that was created. Now,

1050
00:41:55,119 --> 00:41:58,000
let's save it.

1051
00:41:58,000 --> 00:42:00,560
And in our controller,

1052
00:42:00,560 --> 00:42:03,839
we essentially want to I'm actually

1053
00:42:03,839 --> 00:42:06,160
going to just clear this text out

1054
00:42:06,160 --> 00:42:07,599
because it's quite a bit and a bit

1055
00:42:07,599 --> 00:42:10,000
noisy.

1056
00:42:10,000 --> 00:42:12,000
And all we're going to do, notice how

1057
00:42:12,000 --> 00:42:14,079
it's nice and clean because we separated

1058
00:42:14,079 --> 00:42:16,319
our logic into the service. We're just

1059
00:42:16,319 --> 00:42:18,960
going to return this profile service and

1060
00:42:18,960 --> 00:42:20,560
we're going to call our new created

1061
00:42:20,560 --> 00:42:23,040
function. And we are just going to pass

1062
00:42:23,040 --> 00:42:25,520
in the body that we received. And that's

1063
00:42:25,520 --> 00:42:27,920
it. Like I said, the code is pretty

1064
00:42:27,920 --> 00:42:30,880
minimal, but as you kind of jump from

1065
00:42:30,880 --> 00:42:33,359
different layers and you're separating

1066
00:42:33,359 --> 00:42:35,200
different concerns in a larger

1067
00:42:35,200 --> 00:42:37,359
application, it just takes some getting

1068
00:42:37,359 --> 00:42:40,000
used to and hopping back and forth. And

1069
00:42:40,000 --> 00:42:41,680
maybe this was fine for you. But if you

1070
00:42:41,680 --> 00:42:43,200
did feel a little bit overwhelmed with

1071
00:42:43,200 --> 00:42:44,880
all the steps, that's okay. We're going

1072
00:42:44,880 --> 00:42:46,319
to continue to practice. You're going to

1073
00:42:46,319 --> 00:42:48,800
get more comfortable with it. But, you

1074
00:42:48,800 --> 00:42:50,720
know, we could just be wrong. Maybe I

1075
00:42:50,720 --> 00:42:52,480
broke it. So, we still need to test

1076
00:42:52,480 --> 00:42:56,640
this. So, let's open up uh our tabs and

1077
00:42:56,640 --> 00:42:58,880
we are going to go to the terminal and

1078
00:42:58,880 --> 00:43:02,839
we're just going to type in bashhost.sh.

1079
00:43:03,119 --> 00:43:05,440
All right, success. Well, hopefully,

1080
00:43:05,440 --> 00:43:07,040
let's just double check. I like to

1081
00:43:07,040 --> 00:43:09,359
double check. Let's go to our network

1082
00:43:09,359 --> 00:43:11,920
tab and then we are just going to make a

1083
00:43:11,920 --> 00:43:14,319
new request to get all profiles. We see

1084
00:43:14,319 --> 00:43:18,640
Briana, Jasper, Leo. Uh-oh. So, it looks

1085
00:43:18,640 --> 00:43:20,480
like this is not working. This is why we

1086
00:43:20,480 --> 00:43:22,480
double check. Now, you guys might have

1087
00:43:22,480 --> 00:43:24,640
spotted the bugs and you might have just

1088
00:43:24,640 --> 00:43:26,880
been maybe yelling at your screen, dod

1089
00:43:26,880 --> 00:43:29,040
go back, change this, and good. If you

1090
00:43:29,040 --> 00:43:31,680
did, uh, if not, that's okay. Uh, but

1091
00:43:31,680 --> 00:43:33,200
this is why we double check. So, we're

1092
00:43:33,200 --> 00:43:34,640
going to go back to the service file.

1093
00:43:34,640 --> 00:43:36,720
Here's our two bugs. And I'm going to

1094
00:43:36,720 --> 00:43:38,880
tell you what kind of hinted towards me

1095
00:43:38,880 --> 00:43:41,359
being able to figure this out.

1096
00:43:41,359 --> 00:43:44,480
We have our runner. Don't forget to

1097
00:43:44,480 --> 00:43:47,760
check this. So in the runner, it looks

1098
00:43:47,760 --> 00:43:52,079
like we are just trying to get the DTO

1099
00:43:52,079 --> 00:43:54,160
type from a file that doesn't exist

1100
00:43:54,160 --> 00:43:56,079
because we made this plural when it

1101
00:43:56,079 --> 00:43:57,839
should be singular. We're creating one

1102
00:43:57,839 --> 00:44:01,119
profile. Now let's look at our profile

1103
00:44:01,119 --> 00:44:04,560
and we have a new bug. ID is declared

1104
00:44:04,560 --> 00:44:08,880
here. So let's go ahead and scroll down.

1105
00:44:08,880 --> 00:44:12,240
Now what we're doing is we are pushing

1106
00:44:12,240 --> 00:44:15,440
an object essentially that just has a

1107
00:44:15,440 --> 00:44:17,520
name and description. So if we go to

1108
00:44:17,520 --> 00:44:20,240
create profile, this is essentially the

1109
00:44:20,240 --> 00:44:24,640
type that this array is expecting and we

1110
00:44:24,640 --> 00:44:26,960
are just sending the wrong thing. We're

1111
00:44:26,960 --> 00:44:28,240
sending the body. We don't want to do

1112
00:44:28,240 --> 00:44:29,520
that. We want to send the created

1113
00:44:29,520 --> 00:44:32,720
profile. So let's go ahead and send the

1114
00:44:32,720 --> 00:44:36,880
proper object. Let's click save. Cool.

1115
00:44:36,880 --> 00:44:38,800
Seems like it's happy.

1116
00:44:38,800 --> 00:44:41,359
Now, I don't think it successfully sent

1117
00:44:41,359 --> 00:44:43,760
this and added the entry. Well,

1118
00:44:43,760 --> 00:44:46,000
obviously it didn't. And if I would have

1119
00:44:46,000 --> 00:44:47,599
noticed this and I would have taken a

1120
00:44:47,599 --> 00:44:49,520
closer look, you notice that there is no

1121
00:44:49,520 --> 00:44:52,079
ID, right? So, this could have been a

1122
00:44:52,079 --> 00:44:53,839
hint, but we have a lot of tools at our

1123
00:44:53,839 --> 00:44:56,480
disposal to be able to debug this stuff.

1124
00:44:56,480 --> 00:44:58,720
But, we need to go ahead and call the

1125
00:44:58,720 --> 00:45:01,280
bash script one more time. So, we're

1126
00:45:01,280 --> 00:45:04,880
going to type bash and then post sh. We

1127
00:45:04,880 --> 00:45:08,160
do see the ID. That looks promising. All

1128
00:45:08,160 --> 00:45:10,800
right, fingers crossed. Let's click

1129
00:45:10,800 --> 00:45:13,599
send. And ooh, looks like we might have

1130
00:45:13,599 --> 00:45:16,079
a bonus profile. So, we have Briana,

1131
00:45:16,079 --> 00:45:20,160
Jasper, Leo, and Kai. Success. Now, I

1132
00:45:20,160 --> 00:45:21,440
actually think it's pretty cool that I

1133
00:45:21,440 --> 00:45:24,640
created some bugs, honestly. Like, I can

1134
00:45:24,640 --> 00:45:26,319
still use refreshers. Everyone can still

1135
00:45:26,319 --> 00:45:28,800
use refreshers. And it just gets further

1136
00:45:28,800 --> 00:45:30,800
reinforced when you do hit that wall and

1137
00:45:30,800 --> 00:45:32,720
then you overcome it. So, if you are

1138
00:45:32,720 --> 00:45:34,880
creating bugs and you are struggling,

1139
00:45:34,880 --> 00:45:36,319
that is a good thing. that's where the

1140
00:45:36,319 --> 00:45:38,640
learning is happening. So, don't shy

1141
00:45:38,640 --> 00:45:40,880
away from that. But also, it was just

1142
00:45:40,880 --> 00:45:43,040
kind of cool to be able to go over how

1143
00:45:43,040 --> 00:45:44,720
we might spot some of these bugs. And

1144
00:45:44,720 --> 00:45:46,640
again, just a good reminder to use this

1145
00:45:46,640 --> 00:45:48,720
runner. It'll catch a lot of stuff for

1146
00:45:48,720 --> 00:45:50,880
you, double check if things aren't going

1147
00:45:50,880 --> 00:45:53,280
right. But that's it. We've created our

1148
00:45:53,280 --> 00:45:54,960
logic to be able to handle actually

1149
00:45:54,960 --> 00:45:56,720
creating a profile and returning it back

1150
00:45:56,720 --> 00:45:59,440
to the client. In the next lesson, we

1151
00:45:59,440 --> 00:46:01,839
will work on updating a profile that's

1152
00:46:01,839 --> 00:46:03,680
already been created. I'll see you

1153
00:46:03,680 --> 00:46:06,560
there.

1154
00:46:06,720 --> 00:46:09,680
All right. So, we don't want to stay

1155
00:46:09,680 --> 00:46:11,680
with the same profile forever. We want

1156
00:46:11,680 --> 00:46:13,839
the ability to update our dating

1157
00:46:13,839 --> 00:46:15,520
profile, and that's what we're going to

1158
00:46:15,520 --> 00:46:17,760
build out. So, let's go ahead and jump

1159
00:46:17,760 --> 00:46:20,800
into it. Here is your challenge. What

1160
00:46:20,800 --> 00:46:22,880
you're going to do is you are going to

1161
00:46:22,880 --> 00:46:24,880
add an update method in the service

1162
00:46:24,880 --> 00:46:27,119
layer. It's going to take an ID and an

1163
00:46:27,119 --> 00:46:30,319
object. In that object, you can expect a

1164
00:46:30,319 --> 00:46:32,000
name and a description. Essentially,

1165
00:46:32,000 --> 00:46:34,160
that object is just going to be what we

1166
00:46:34,160 --> 00:46:36,800
get from the body when we get a put

1167
00:46:36,800 --> 00:46:39,119
request. It should find the matching

1168
00:46:39,119 --> 00:46:41,839
profile based on the ID. It should

1169
00:46:41,839 --> 00:46:43,920
update that profile in the profiles

1170
00:46:43,920 --> 00:46:45,920
array. It should return the updated

1171
00:46:45,920 --> 00:46:48,319
profile. And then we're going to call

1172
00:46:48,319 --> 00:46:50,400
that function in our put controller

1173
00:46:50,400 --> 00:46:52,880
method and return the result. Now, we've

1174
00:46:52,880 --> 00:46:54,079
already gotten some practice with

1175
00:46:54,079 --> 00:46:55,440
hopping back and forth between the

1176
00:46:55,440 --> 00:46:56,880
service layer and the controller layer.

1177
00:46:56,880 --> 00:46:58,880
So, I trim the instructions a bit.

1178
00:46:58,880 --> 00:47:01,280
Hopefully, this is easier to read. Oh,

1179
00:47:01,280 --> 00:47:03,200
and one more thing. You'll probably

1180
00:47:03,200 --> 00:47:05,200
experience TypeScript errors when trying

1181
00:47:05,200 --> 00:47:07,040
to update a profile when there's no

1182
00:47:07,040 --> 00:47:09,440
match. So, for now, when there isn't a

1183
00:47:09,440 --> 00:47:12,079
match, just return an empty object.

1184
00:47:12,079 --> 00:47:14,079
Soon, we'll dive into exception filters,

1185
00:47:14,079 --> 00:47:15,920
which will help us better respond to

1186
00:47:15,920 --> 00:47:18,079
exceptions like when a resource doesn't

1187
00:47:18,079 --> 00:47:20,400
exist. You can use the bash script

1188
00:47:20,400 --> 00:47:22,800
already created for you here. If we open

1189
00:47:22,800 --> 00:47:26,319
this up, you'll need to replace this ID

1190
00:47:26,319 --> 00:47:28,880
with one that exists in a profile. So to

1191
00:47:28,880 --> 00:47:30,319
get that, you'll need to get all of the

1192
00:47:30,319 --> 00:47:32,240
current profiles with their unique IDs

1193
00:47:32,240 --> 00:47:34,560
and use one of those. You already know

1194
00:47:34,560 --> 00:47:36,000
how to do that. You've done that in the

1195
00:47:36,000 --> 00:47:38,160
last lesson. Or if you want to get more

1196
00:47:38,160 --> 00:47:40,960
experience with just making requests and

1197
00:47:40,960 --> 00:47:43,200
getting the IDs from those requests, now

1198
00:47:43,200 --> 00:47:45,040
that we've properly hooked up the post

1199
00:47:45,040 --> 00:47:46,800
route, you can create a profile of your

1200
00:47:46,800 --> 00:47:49,200
own and then just update it. All right,

1201
00:47:49,200 --> 00:47:53,720
I'll let you get to it. Good luck.

1202
00:47:54,640 --> 00:47:56,880
I hope that went well. All right, let's

1203
00:47:56,880 --> 00:47:59,920
go ahead and start off with building our

1204
00:47:59,920 --> 00:48:02,560
service method.

1205
00:48:02,560 --> 00:48:07,119
So, we are going to create a method.

1206
00:48:07,119 --> 00:48:10,000
We'll just call it update. Again, that

1207
00:48:10,000 --> 00:48:11,760
method is going to take an ID, which is

1208
00:48:11,760 --> 00:48:15,200
going to be a string. And then

1209
00:48:15,200 --> 00:48:19,359
we'll want to get the body. And we do

1210
00:48:19,359 --> 00:48:21,599
need to import this. So, I'll go ahead

1211
00:48:21,599 --> 00:48:24,079
and just quickly import the type. Let's

1212
00:48:24,079 --> 00:48:28,559
scroll on down and finish this.

1213
00:48:28,559 --> 00:48:30,640
Perfect.

1214
00:48:30,640 --> 00:48:32,400
So, we'll need to find the matching

1215
00:48:32,400 --> 00:48:34,800
profile and we can use the find method

1216
00:48:34,800 --> 00:48:37,359
to do that. So, let's go ahead and just

1217
00:48:37,359 --> 00:48:40,079
store this

1218
00:48:40,079 --> 00:48:42,079
and

1219
00:48:42,079 --> 00:48:45,119
whoops. Find is going to take uh let's

1220
00:48:45,119 --> 00:48:47,440
actually bring this down. Uh we'll

1221
00:48:47,440 --> 00:48:49,760
actually be explicit here. So, existing

1222
00:48:49,760 --> 00:48:52,760
profile

1223
00:48:52,960 --> 00:48:56,000
and we want to match the ID of our

1224
00:48:56,000 --> 00:48:58,480
current iteration

1225
00:48:58,480 --> 00:49:01,359
with the ID that we're passing through

1226
00:49:01,359 --> 00:49:04,240
here. And just so that we don't hit any

1227
00:49:04,240 --> 00:49:06,000
errors with trying to update the match

1228
00:49:06,000 --> 00:49:07,760
chain profile, which we're going to do,

1229
00:49:07,760 --> 00:49:09,359
if it doesn't exist, we're going to have

1230
00:49:09,359 --> 00:49:11,440
problems with that. So, let's go ahead

1231
00:49:11,440 --> 00:49:13,280
and escape early and just return that

1232
00:49:13,280 --> 00:49:17,520
empty object if we don't find a matching

1233
00:49:17,520 --> 00:49:18,960
profile.

1234
00:49:18,960 --> 00:49:20,559
And so we're just going to return an

1235
00:49:20,559 --> 00:49:23,359
empty object here. Now, we want to

1236
00:49:23,359 --> 00:49:26,559
update the name of the matching profile.

1237
00:49:26,559 --> 00:49:27,839
And then we're going to go ahead and

1238
00:49:27,839 --> 00:49:30,559
update the description as well. And then

1239
00:49:30,559 --> 00:49:32,720
the last thing we need to do is just

1240
00:49:32,720 --> 00:49:36,640
return that profile. Let's go back over

1241
00:49:36,640 --> 00:49:39,680
to our controller. And so right now

1242
00:49:39,680 --> 00:49:41,920
we're just returning the ID we received

1243
00:49:41,920 --> 00:49:45,040
from the prams and the body. So we can

1244
00:49:45,040 --> 00:49:46,559
go ahead and delete that. In fact, I'm

1245
00:49:46,559 --> 00:49:49,440
going to delete all of this.

1246
00:49:49,440 --> 00:49:52,319
And all we need to do is just return the

1247
00:49:52,319 --> 00:49:54,319
new created method that we're going to

1248
00:49:54,319 --> 00:49:55,599
call. We're going to return the result

1249
00:49:55,599 --> 00:49:58,480
from that. But we need to pass in the ID

1250
00:49:58,480 --> 00:50:02,319
and the body. That should do it. But as

1251
00:50:02,319 --> 00:50:05,040
always, we need to test. So let's bring

1252
00:50:05,040 --> 00:50:08,480
up the terminal. Let's go over here. So

1253
00:50:08,480 --> 00:50:10,319
we're just going to type bash and then

1254
00:50:10,319 --> 00:50:12,000
putsh.

1255
00:50:12,000 --> 00:50:14,720
Now, I just want to type this in because

1256
00:50:14,720 --> 00:50:16,640
this is not going to work because of

1257
00:50:16,640 --> 00:50:18,480
what I explained before. We're going to

1258
00:50:18,480 --> 00:50:20,000
have to change the ID. So, we're getting

1259
00:50:20,000 --> 00:50:22,800
an empty object cuz nothing is matching.

1260
00:50:22,800 --> 00:50:24,480
So, the very first thing we actually

1261
00:50:24,480 --> 00:50:27,520
need to do is we need to get all of the

1262
00:50:27,520 --> 00:50:30,480
profiles and we need to get an active

1263
00:50:30,480 --> 00:50:33,760
ID. So, let's grab Jaspers

1264
00:50:33,760 --> 00:50:35,920
and we're going to go ahead and go down

1265
00:50:35,920 --> 00:50:40,640
to let's actually just close that. put

1266
00:50:40,640 --> 00:50:44,079
we need to change this ID here.

1267
00:50:44,079 --> 00:50:46,319
Let's go ahead and change it. Let's

1268
00:50:46,319 --> 00:50:48,640
click save. Let's open up our terminal

1269
00:50:48,640 --> 00:50:50,400
again.

1270
00:50:50,400 --> 00:50:53,599
Clear this. And one more time. And

1271
00:50:53,599 --> 00:50:56,720
success. So, we were able to update the

1272
00:50:56,720 --> 00:50:58,720
profile. Again, we need a matching ID,

1273
00:50:58,720 --> 00:51:01,280
otherwise we just get an empty object.

1274
00:51:01,280 --> 00:51:03,440
And now, let's go ahead and just double

1275
00:51:03,440 --> 00:51:05,359
check. Let's go to the network tab.

1276
00:51:05,359 --> 00:51:06,800
We're going to make another request. And

1277
00:51:06,800 --> 00:51:09,200
we can see that Jasper was replaced with

1278
00:51:09,200 --> 00:51:12,640
Kai. Success. That's all there is to it.

1279
00:51:12,640 --> 00:51:14,880
Now, we are almost done with our main

1280
00:51:14,880 --> 00:51:16,640
service methods. We have one more method

1281
00:51:16,640 --> 00:51:18,480
to create, and that's our method to

1282
00:51:18,480 --> 00:51:20,559
handle removing a profile. We'll go

1283
00:51:20,559 --> 00:51:21,760
ahead and tackle that in the next

1284
00:51:21,760 --> 00:51:25,880
lesson. I'll see you there.

1285
00:51:25,920 --> 00:51:27,280
All right, let's go ahead and create our

1286
00:51:27,280 --> 00:51:28,720
last service method that's going to

1287
00:51:28,720 --> 00:51:30,079
match up with the routes that we

1288
00:51:30,079 --> 00:51:32,319
created. So, we are going to remove a

1289
00:51:32,319 --> 00:51:34,640
profile now. So, I'm going to go ahead

1290
00:51:34,640 --> 00:51:36,640
and give you your assignment. You're

1291
00:51:36,640 --> 00:51:38,640
going to create a method in the service

1292
00:51:38,640 --> 00:51:41,440
file to handle the delete request. It

1293
00:51:41,440 --> 00:51:43,839
should take an ID and delete the profile

1294
00:51:43,839 --> 00:51:45,760
that matches that ID. If there's no

1295
00:51:45,760 --> 00:51:47,440
match, don't do anything with the

1296
00:51:47,440 --> 00:51:49,119
profiles array. You just don't delete

1297
00:51:49,119 --> 00:51:50,960
anything. Regardless of whether or not

1298
00:51:50,960 --> 00:51:52,480
it finds a match, don't worry about

1299
00:51:52,480 --> 00:51:53,760
returning anything in the service

1300
00:51:53,760 --> 00:51:56,160
method. In a later lesson, we'll handle

1301
00:51:56,160 --> 00:51:58,640
the case where there's no match. So you

1302
00:51:58,640 --> 00:52:00,640
could just essentially return undefined

1303
00:52:00,640 --> 00:52:02,400
or not return anything at all because

1304
00:52:02,400 --> 00:52:04,480
undefined is going to be default. Our

1305
00:52:04,480 --> 00:52:06,400
controller is already properly

1306
00:52:06,400 --> 00:52:09,359
responding with a 204 and an empty body.

1307
00:52:09,359 --> 00:52:10,880
So you just need to call the service

1308
00:52:10,880 --> 00:52:14,079
method in the controller. That's it.

1309
00:52:14,079 --> 00:52:16,240
Don't forget to test your new route. We

1310
00:52:16,240 --> 00:52:18,640
have a shell script here. You're going

1311
00:52:18,640 --> 00:52:20,880
to need to open this up and change this

1312
00:52:20,880 --> 00:52:23,280
ID with an active ID. You already know

1313
00:52:23,280 --> 00:52:25,680
how to get active profiles, so you'll

1314
00:52:25,680 --> 00:52:28,000
need to do that. and then run the shell

1315
00:52:28,000 --> 00:52:30,000
script in the terminal. All right, I'll

1316
00:52:30,000 --> 00:52:34,359
let you get to it. Good luck.

1317
00:52:36,240 --> 00:52:38,640
I hope that went well. Let's go ahead

1318
00:52:38,640 --> 00:52:41,119
and build this out. So, let's go ahead

1319
00:52:41,119 --> 00:52:45,520
and just create a remove function here.

1320
00:52:45,520 --> 00:52:48,480
Um, we're going to receive an ID. That

1321
00:52:48,480 --> 00:52:52,079
ID is going to be a string.

1322
00:52:52,079 --> 00:52:53,839
Be a little bit explicit with

1323
00:52:53,839 --> 00:52:57,839
TypeScript. And then we are going to

1324
00:52:57,839 --> 00:53:01,440
need to get the matching profile index.

1325
00:53:01,440 --> 00:53:03,680
And what I'd like to use is splice to be

1326
00:53:03,680 --> 00:53:06,160
able to do this. So get the index. We're

1327
00:53:06,160 --> 00:53:08,720
just going to use find index. And we

1328
00:53:08,720 --> 00:53:12,240
want to match the profile ID of the

1329
00:53:12,240 --> 00:53:15,520
current iteration with the ID that we're

1330
00:53:15,520 --> 00:53:18,559
passing through. And then let's go ahead

1331
00:53:18,559 --> 00:53:23,680
and just splice the array if we find a

1332
00:53:23,680 --> 00:53:27,119
matching index. So if we don't find a

1333
00:53:27,119 --> 00:53:29,200
matching index,

1334
00:53:29,200 --> 00:53:31,599
we're going to get negative 1.

1335
00:53:31,599 --> 00:53:33,839
But anything above negative 1, we're

1336
00:53:33,839 --> 00:53:36,720
going to assume that we do find a match.

1337
00:53:36,720 --> 00:53:41,280
And then we'll just use splice

1338
00:53:41,280 --> 00:53:44,640
to edit our array in place. So, that

1339
00:53:44,640 --> 00:53:46,559
should be it for the service method.

1340
00:53:46,559 --> 00:53:48,000
Let's go ahead and go on over to the

1341
00:53:48,000 --> 00:53:49,599
controller.

1342
00:53:49,599 --> 00:53:51,280
And then we're going to remove this

1343
00:53:51,280 --> 00:53:53,839
text.

1344
00:53:53,839 --> 00:53:56,480
And all we're going to do, again, really

1345
00:53:56,480 --> 00:53:59,200
simple, call our newly created method.

1346
00:53:59,200 --> 00:54:02,319
And we need to pass in the ID. So, it

1347
00:54:02,319 --> 00:54:05,040
should work. But as always, we want to

1348
00:54:05,040 --> 00:54:07,760
double check. We want to test.

1349
00:54:07,760 --> 00:54:09,920
So, let's go ahead and just get some

1350
00:54:09,920 --> 00:54:13,200
active IDs. We're going to delete Leo.

1351
00:54:13,200 --> 00:54:15,440
Let's copy and paste this. Uh, we need

1352
00:54:15,440 --> 00:54:19,359
to go into our shell script.

1353
00:54:19,359 --> 00:54:22,079
And then we could just paste that there.

1354
00:54:22,079 --> 00:54:24,240
And then we're going to just go to our

1355
00:54:24,240 --> 00:54:26,319
terminal.

1356
00:54:26,319 --> 00:54:28,480
Let's go ahead and try it out. And I

1357
00:54:28,480 --> 00:54:30,480
think I said shell script. Um, bash

1358
00:54:30,480 --> 00:54:32,319
script is just a type of shell script.

1359
00:54:32,319 --> 00:54:34,240
So you can use those interchangeably in

1360
00:54:34,240 --> 00:54:36,559
this example. So we're going to just

1361
00:54:36,559 --> 00:54:39,839
type bash and delete.sh.

1362
00:54:39,839 --> 00:54:42,640
So we are getting a 204. Success.

1363
00:54:42,640 --> 00:54:46,240
Remember, we are serving up a 204

1364
00:54:46,240 --> 00:54:47,839
always. So, that could be a little bit

1365
00:54:47,839 --> 00:54:50,000
misleading. So, we're going to go ahead

1366
00:54:50,000 --> 00:54:51,920
and just make sure that the method was

1367
00:54:51,920 --> 00:54:53,920
called and it did work. Let's go back

1368
00:54:53,920 --> 00:54:56,400
over to our network tab and do another

1369
00:54:56,400 --> 00:54:59,280
scan. Looks like we only have Briana and

1370
00:54:59,280 --> 00:55:01,040
Jasper. So, that deletion was

1371
00:55:01,040 --> 00:55:03,920
successful. And that's it. We pretty

1372
00:55:03,920 --> 00:55:05,839
much created all the service methods to

1373
00:55:05,839 --> 00:55:08,400
match up with the logic that we need to

1374
00:55:08,400 --> 00:55:10,880
happen whenever we get a certain type of

1375
00:55:10,880 --> 00:55:13,200
request in our controller. So, this

1376
00:55:13,200 --> 00:55:15,040
might even be a good chance to take a

1377
00:55:15,040 --> 00:55:16,559
break if you've been coding for a long

1378
00:55:16,559 --> 00:55:19,280
time. Come back refreshed and I'll see

1379
00:55:19,280 --> 00:55:22,760
you in the next lesson.

1380
00:55:23,200 --> 00:55:25,599
Up until this point, we've mainly just

1381
00:55:25,599 --> 00:55:28,160
been building for the happy path in real

1382
00:55:28,160 --> 00:55:30,480
apps with the real users. This is just

1383
00:55:30,480 --> 00:55:32,720
unrealistic. We're going to also have to

1384
00:55:32,720 --> 00:55:34,800
handle edge cases and errors that pop

1385
00:55:34,800 --> 00:55:37,760
up. Nest actually comes with a built-in

1386
00:55:37,760 --> 00:55:40,079
exception layer which aims to handle all

1387
00:55:40,079 --> 00:55:43,040
unhandled exceptions or errors across

1388
00:55:43,040 --> 00:55:45,520
the application. If an exception is

1389
00:55:45,520 --> 00:55:47,920
unrecognized, Nest aims to at least

1390
00:55:47,920 --> 00:55:50,720
respond with a 500. Often though, we'll

1391
00:55:50,720 --> 00:55:52,559
want to control how we respond to the

1392
00:55:52,559 --> 00:55:55,359
client. So, let's jump into it. First of

1393
00:55:55,359 --> 00:55:59,920
all, we're going to need HTTP status and

1394
00:55:59,920 --> 00:56:01,760
HTTP

1395
00:56:01,760 --> 00:56:03,920
exception.

1396
00:56:03,920 --> 00:56:06,720
Let's go on over to our get with a

1397
00:56:06,720 --> 00:56:08,960
parameter of ID. So, if we're trying to

1398
00:56:08,960 --> 00:56:11,440
get a single profile, we want a profile

1399
00:56:11,440 --> 00:56:14,079
that matches that ID. But what if the ID

1400
00:56:14,079 --> 00:56:15,440
doesn't match? We want to be able to

1401
00:56:15,440 --> 00:56:18,720
handle that case. Well, for now, let's

1402
00:56:18,720 --> 00:56:22,559
actually comment this out and let's just

1403
00:56:22,559 --> 00:56:25,760
throw an HTTP exception and let the user

1404
00:56:25,760 --> 00:56:27,359
know that we didn't find the resource.

1405
00:56:27,359 --> 00:56:28,480
So, we're not even going to do anything

1406
00:56:28,480 --> 00:56:30,319
with the ID. We're just going to test

1407
00:56:30,319 --> 00:56:32,960
this new exception thing out. So, let's

1408
00:56:32,960 --> 00:56:37,280
go ahead and throw new HTTP exception.

1409
00:56:37,280 --> 00:56:38,720
And so, the message we're going to

1410
00:56:38,720 --> 00:56:41,280
deliver is a not found,

1411
00:56:41,280 --> 00:56:43,680
but an important thing that all the

1412
00:56:43,680 --> 00:56:45,920
clients are going to especially want is

1413
00:56:45,920 --> 00:56:48,400
the status code. And so, again, Nest

1414
00:56:48,400 --> 00:56:50,240
provides us with a lot of the common

1415
00:56:50,240 --> 00:56:52,559
status codes. And we're going to go

1416
00:56:52,559 --> 00:56:55,520
ahead and just serve up a 404.

1417
00:56:55,520 --> 00:56:58,319
So, in order to test this, we're going

1418
00:56:58,319 --> 00:56:59,760
to go ahead and try to get a single

1419
00:56:59,760 --> 00:57:01,680
profile and see if this works. If it

1420
00:57:01,680 --> 00:57:03,520
does, we're going to get a 404 in

1421
00:57:03,520 --> 00:57:07,520
response. So, let's test this out. And

1422
00:57:07,520 --> 00:57:09,200
let's just do some random ID that

1423
00:57:09,200 --> 00:57:12,079
probably doesn't exist. Not found. So,

1424
00:57:12,079 --> 00:57:14,720
we see a status code of 404. Let me

1425
00:57:14,720 --> 00:57:16,640
actually

1426
00:57:16,640 --> 00:57:18,400
scroll.

1427
00:57:18,400 --> 00:57:20,640
We're seeing the message not found and

1428
00:57:20,640 --> 00:57:23,839
we're seeing the status code of 404. So,

1429
00:57:23,839 --> 00:57:26,720
it's working. Nest actually provides a

1430
00:57:26,720 --> 00:57:28,240
set of standard exceptions that are

1431
00:57:28,240 --> 00:57:31,280
inherited from the base HTTP exception.

1432
00:57:31,280 --> 00:57:33,200
And often we'll throw that in the

1433
00:57:33,200 --> 00:57:35,040
controller. So, we'll just kind of clean

1434
00:57:35,040 --> 00:57:37,280
this up a little bit. Let's go ahead and

1435
00:57:37,280 --> 00:57:40,480
get rid of HTTP exception.

1436
00:57:40,480 --> 00:57:42,480
And we'll come back down. So, this isn't

1437
00:57:42,480 --> 00:57:44,400
going to work anymore, but what we are

1438
00:57:44,400 --> 00:57:49,520
going to use is not found exception.

1439
00:57:49,520 --> 00:57:51,760
So, that's essentially going to do the

1440
00:57:51,760 --> 00:57:54,319
same thing. Um, all I really care about

1441
00:57:54,319 --> 00:57:57,599
is serving up that status code. And this

1442
00:57:57,599 --> 00:57:59,599
will go ahead and deliver that. So,

1443
00:57:59,599 --> 00:58:01,359
let's go ahead and save with that. And

1444
00:58:01,359 --> 00:58:04,480
it'll respond to our client request no

1445
00:58:04,480 --> 00:58:07,520
matter what ID we give it. Not found.

1446
00:58:07,520 --> 00:58:09,599
And it has its own default message.

1447
00:58:09,599 --> 00:58:12,160
Notice we did not have to put that in.

1448
00:58:12,160 --> 00:58:15,520
So, this is a little bit cleaner. Now,

1449
00:58:15,520 --> 00:58:16,799
let me show you a really cool thing

1450
00:58:16,799 --> 00:58:20,960
about Nest. Let's go over to our Let's

1451
00:58:20,960 --> 00:58:22,400
actually comment this out. And then

1452
00:58:22,400 --> 00:58:24,000
we're going to go over to our service

1453
00:58:24,000 --> 00:58:27,000
file

1454
00:58:27,760 --> 00:58:31,040
and let's look at the find one. Let's go

1455
00:58:31,040 --> 00:58:33,040
ahead and just throw an exception before

1456
00:58:33,040 --> 00:58:35,040
the return. So no matter what, whenever

1457
00:58:35,040 --> 00:58:36,559
we call this function, we're always

1458
00:58:36,559 --> 00:58:38,319
going to be throwing an exception. But

1459
00:58:38,319 --> 00:58:42,400
we do need to import the not found

1460
00:58:42,400 --> 00:58:45,200
exception from nest common. Let's save

1461
00:58:45,200 --> 00:58:46,799
that.

1462
00:58:46,799 --> 00:58:49,119
And then we're just going to call that

1463
00:58:49,119 --> 00:58:51,119
here.

1464
00:58:51,119 --> 00:58:52,720
So let's go ahead and save this. And

1465
00:58:52,720 --> 00:58:54,160
then we're going to go back to our

1466
00:58:54,160 --> 00:59:00,400
controller and we are going to just call

1467
00:59:00,400 --> 00:59:02,720
profile service

1468
00:59:02,720 --> 00:59:04,400
and return it. In fact, we don't even

1469
00:59:04,400 --> 00:59:06,319
need to return it. I'm going to show you

1470
00:59:06,319 --> 00:59:09,359
this. So let's go ahead and save this

1471
00:59:09,359 --> 00:59:11,760
and we'll make the same request. And we

1472
00:59:11,760 --> 00:59:15,119
got a 404 again. Now we're not even

1473
00:59:15,119 --> 00:59:17,599
returning anything, right? So the cool

1474
00:59:17,599 --> 00:59:19,760
part is

1475
00:59:19,760 --> 00:59:22,400
we just call this function and any

1476
00:59:22,400 --> 00:59:25,119
errors are thrown here, they're going to

1477
00:59:25,119 --> 00:59:28,079
bubble up to the controller and nest

1478
00:59:28,079 --> 00:59:30,319
just provides that convenience for you.

1479
00:59:30,319 --> 00:59:33,200
Right? So this is a pretty convenient

1480
00:59:33,200 --> 00:59:35,359
because as you'll see in a second, this

1481
00:59:35,359 --> 00:59:37,599
will be really useful for this method.

1482
00:59:37,599 --> 00:59:39,359
Right? What happens when we don't find a

1483
00:59:39,359 --> 00:59:41,440
profile? So again, we go back to the

1484
00:59:41,440 --> 00:59:43,520
controller. We don't even need to return

1485
00:59:43,520 --> 00:59:45,520
this. We can. It doesn't matter if we

1486
00:59:45,520 --> 00:59:48,799
return it or not because once we throw

1487
00:59:48,799 --> 00:59:51,359
this exception, this takes over and this

1488
00:59:51,359 --> 00:59:53,680
is what's served back to the client. And

1489
00:59:53,680 --> 00:59:55,760
what does a client see? Status code of

1490
00:59:55,760 --> 00:59:59,200
404 not found. So let's actually be

1491
00:59:59,200 --> 01:00:01,119
practical about this. We don't always

1492
01:00:01,119 --> 01:00:03,520
want to throw this. What we probably

1493
01:00:03,520 --> 01:00:06,559
want to do is check if there's a

1494
01:00:06,559 --> 01:00:09,440
matching profile. If there is a matching

1495
01:00:09,440 --> 01:00:11,359
profile, we want to go ahead and return

1496
01:00:11,359 --> 01:00:13,839
this. If not, then we want to go ahead

1497
01:00:13,839 --> 01:00:16,240
and return that 404 or throw an

1498
01:00:16,240 --> 01:00:17,760
exception and allow that to be caught

1499
01:00:17,760 --> 01:00:19,920
and served up to the client. So, let's

1500
01:00:19,920 --> 01:00:23,359
go ahead and delete this.

1501
01:00:23,359 --> 01:00:26,480
And we are going to store this in a

1502
01:00:26,480 --> 01:00:28,319
variable. Let's call it matching

1503
01:00:28,319 --> 01:00:31,319
profile.

1504
01:00:32,240 --> 01:00:36,319
If there is no matching profile,

1505
01:00:36,319 --> 01:00:39,119
we want to go ahead and throw that new

1506
01:00:39,119 --> 01:00:42,000
not found exception. And we can actually

1507
01:00:42,000 --> 01:00:44,160
provide a custom error message. I just

1508
01:00:44,160 --> 01:00:46,559
wanted to show you this. Um, let's make

1509
01:00:46,559 --> 01:00:51,599
it a practical profile with ID

1510
01:00:51,599 --> 01:00:53,200
ID

1511
01:00:53,200 --> 01:00:55,440
not found.

1512
01:00:55,440 --> 01:00:59,040
And then if this condition is never met,

1513
01:00:59,040 --> 01:01:00,960
we want to go ahead and just return the

1514
01:01:00,960 --> 01:01:03,280
matching profile. Let's go back over to

1515
01:01:03,280 --> 01:01:06,319
our controller. So we are calling this.

1516
01:01:06,319 --> 01:01:07,839
We can actually get rid of this just to

1517
01:01:07,839 --> 01:01:10,400
clean it up. So we are calling this

1518
01:01:10,400 --> 01:01:13,359
method and if we find an ID, it should

1519
01:01:13,359 --> 01:01:16,160
return a profile that actually matches.

1520
01:01:16,160 --> 01:01:18,480
And if not, we should get that 404. So

1521
01:01:18,480 --> 01:01:22,119
let's test it out.

1522
01:01:24,079 --> 01:01:26,880
All right. So we do get the error

1523
01:01:26,880 --> 01:01:28,640
message by default. But if we want a

1524
01:01:28,640 --> 01:01:30,400
custom message to also send to the

1525
01:01:30,400 --> 01:01:33,040
client, we have profile with ID and then

1526
01:01:33,040 --> 01:01:34,880
the ID that we passed through not found

1527
01:01:34,880 --> 01:01:38,000
with a 404. So obviously this ID doesn't

1528
01:01:38,000 --> 01:01:40,160
exist. Let's go ahead and just take a

1529
01:01:40,160 --> 01:01:42,559
look at all profiles.

1530
01:01:42,559 --> 01:01:45,920
Let's grab Briana's

1531
01:01:45,920 --> 01:01:47,119
and then we're going to go ahead and

1532
01:01:47,119 --> 01:01:49,920
make a request to Briana.

1533
01:01:49,920 --> 01:01:52,160
And so this is just demonstrating our

1534
01:01:52,160 --> 01:01:54,160
conditional logic is working. If we do

1535
01:01:54,160 --> 01:01:56,640
match a profile, then we serve up the

1536
01:01:56,640 --> 01:01:59,520
profile that's matching. If not, we get

1537
01:01:59,520 --> 01:02:02,960
that 404 error. I think this bubbling up

1538
01:02:02,960 --> 01:02:04,720
behavior is really convenient for

1539
01:02:04,720 --> 01:02:07,359
beginners because in this method, we

1540
01:02:07,359 --> 01:02:09,920
already know that if we don't have a

1541
01:02:09,920 --> 01:02:11,280
matching profile, let's just go ahead

1542
01:02:11,280 --> 01:02:13,040
and handle that exception here, throw

1543
01:02:13,040 --> 01:02:15,200
it, and we're done. No matter what,

1544
01:02:15,200 --> 01:02:17,280
we're calling the function in our

1545
01:02:17,280 --> 01:02:19,839
controller and letting the method in our

1546
01:02:19,839 --> 01:02:21,680
service file just handle everything

1547
01:02:21,680 --> 01:02:23,040
because it has some of the context of

1548
01:02:23,040 --> 01:02:24,720
what it needs to in order to either

1549
01:02:24,720 --> 01:02:27,200
return a matching profile or not. Feel

1550
01:02:27,200 --> 01:02:28,559
free to play around with this as you

1551
01:02:28,559 --> 01:02:30,000
like, but in the next lesson, I'm

1552
01:02:30,000 --> 01:02:31,280
actually going to give you several

1553
01:02:31,280 --> 01:02:33,520
challenges to be able to practice this.

1554
01:02:33,520 --> 01:02:35,119
So, I hope that made sense. If it

1555
01:02:35,119 --> 01:02:36,640
didn't, you'll get practice in the next

1556
01:02:36,640 --> 01:02:40,720
lesson. I'll see you there.

1557
01:02:40,720 --> 01:02:42,319
In this lesson, I'm going to go ahead

1558
01:02:42,319 --> 01:02:44,000
and give you a couple challenges. you

1559
01:02:44,000 --> 01:02:46,799
are going to update the update and

1560
01:02:46,799 --> 01:02:50,400
delete methods to be able to throw the

1561
01:02:50,400 --> 01:02:52,640
proper exception when a matching profile

1562
01:02:52,640 --> 01:02:55,200
is not found. You'll have to change each

1563
01:02:55,200 --> 01:02:56,720
method a little bit differently to make

1564
01:02:56,720 --> 01:02:59,760
that work. But remember, if there is a

1565
01:02:59,760 --> 01:03:01,760
matching profile, we still want to

1566
01:03:01,760 --> 01:03:03,280
return that matching profile. So, make

1567
01:03:03,280 --> 01:03:05,200
sure that works. All right, I'll let you

1568
01:03:05,200 --> 01:03:09,319
get to it. Good luck.

1569
01:03:10,160 --> 01:03:12,079
I hope that went well. Let's go ahead

1570
01:03:12,079 --> 01:03:14,319
and tackle the update method. So we

1571
01:03:14,319 --> 01:03:16,000
already have the conditional to check if

1572
01:03:16,000 --> 01:03:18,000
there isn't a matching profile. So we

1573
01:03:18,000 --> 01:03:21,520
just need to change line 61. And we are

1574
01:03:21,520 --> 01:03:24,400
going to throw our not found exception

1575
01:03:24,400 --> 01:03:26,400
here. And then let's go ahead and

1576
01:03:26,400 --> 01:03:29,200
provide that custom message as well. And

1577
01:03:29,200 --> 01:03:33,920
we'll include oops we'll include the ID.

1578
01:03:33,920 --> 01:03:37,520
And that should be it. Let's go on over

1579
01:03:37,520 --> 01:03:42,880
to our remove method. So, we are

1580
01:03:42,880 --> 01:03:46,960
only editing the array in place if there

1581
01:03:46,960 --> 01:03:49,359
is a matching index. So, we're going to

1582
01:03:49,359 --> 01:03:51,440
change this slightly. Let's bring this

1583
01:03:51,440 --> 01:03:55,039
down. This a little bit of space. And

1584
01:03:55,039 --> 01:03:56,720
then our conditional is something we're

1585
01:03:56,720 --> 01:04:00,000
going to have to change as well. So, I'd

1586
01:04:00,000 --> 01:04:02,400
like to opt out of the method and throw

1587
01:04:02,400 --> 01:04:04,960
that exception early if there's no

1588
01:04:04,960 --> 01:04:08,559
matching profile index. So let's go

1589
01:04:08,559 --> 01:04:11,280
ahead and throw our not found exception

1590
01:04:11,280 --> 01:04:14,240
here. And again let's provide the custom

1591
01:04:14,240 --> 01:04:16,000
error message. I'm going to cheat. Copy

1592
01:04:16,000 --> 01:04:19,039
and paste this.

1593
01:04:19,039 --> 01:04:20,880
All right.

1594
01:04:20,880 --> 01:04:24,960
So that should do it. Now we are

1595
01:04:24,960 --> 01:04:26,799
throwing the exception if there's no

1596
01:04:26,799 --> 01:04:28,720
matching profile index and we are

1597
01:04:28,720 --> 01:04:31,680
editing the array in place if there is a

1598
01:04:31,680 --> 01:04:34,400
matching profile. Now, this will work

1599
01:04:34,400 --> 01:04:36,160
because

1600
01:04:36,160 --> 01:04:39,760
we have our decorator to automatically

1601
01:04:39,760 --> 01:04:41,520
serve up a no content, which is going to

1602
01:04:41,520 --> 01:04:45,119
be a 204 status code. But if we do throw

1603
01:04:45,119 --> 01:04:47,520
that exception, this is what's going to

1604
01:04:47,520 --> 01:04:50,319
take priority. But as always, we want to

1605
01:04:50,319 --> 01:04:53,039
test this. So, let's go ahead and open

1606
01:04:53,039 --> 01:04:55,280
this up. And then we're going to go

1607
01:04:55,280 --> 01:04:58,319
ahead and get all of our profiles.

1608
01:04:58,319 --> 01:04:59,839
So, here's how I'm going to test this.

1609
01:04:59,839 --> 01:05:01,039
There are different ways that you could

1610
01:05:01,039 --> 01:05:03,039
have gone about it. I'm going to go

1611
01:05:03,039 --> 01:05:06,880
ahead and edit Briana and then try to

1612
01:05:06,880 --> 01:05:10,640
delete her. So, let's go ahead and

1613
01:05:10,640 --> 01:05:15,160
change these IDs. Oops.

1614
01:05:16,400 --> 01:05:19,119
And delete as well.

1615
01:05:19,119 --> 01:05:20,400
Now, let's test this out in the

1616
01:05:20,400 --> 01:05:23,520
terminal. So, with Briana, let's go

1617
01:05:23,520 --> 01:05:25,680
ahead and see if we can update her

1618
01:05:25,680 --> 01:05:28,559
profile. So, we're just going to call

1619
01:05:28,559 --> 01:05:31,760
our shell script. And we did get a

1620
01:05:31,760 --> 01:05:34,400
result back. Hopefully this is working.

1621
01:05:34,400 --> 01:05:36,640
I like to just do a quick sanity check.

1622
01:05:36,640 --> 01:05:38,640
Let's go ahead and click send. So we

1623
01:05:38,640 --> 01:05:41,440
have the same ID with Kai and a new

1624
01:05:41,440 --> 01:05:44,319
description. So that was successful. Now

1625
01:05:44,319 --> 01:05:48,359
let's see if we can delete Kai.

1626
01:05:51,200 --> 01:05:53,839
And we got a 204. So let's just make

1627
01:05:53,839 --> 01:05:56,160
sure that Kai was actually deleted. And

1628
01:05:56,160 --> 01:05:59,039
it looks like he was perfect. So now we

1629
01:05:59,039 --> 01:06:01,280
know that that profile no longer exists.

1630
01:06:01,280 --> 01:06:02,799
So it still works when we have a

1631
01:06:02,799 --> 01:06:06,000
matching profile. Let's see if it works

1632
01:06:06,000 --> 01:06:08,559
when we don't have a matching profile.

1633
01:06:08,559 --> 01:06:09,839
Let's go ahead and go back over to the

1634
01:06:09,839 --> 01:06:13,680
terminal. Let's clear this and then

1635
01:06:13,680 --> 01:06:16,000
we're going to try to edit. And it looks

1636
01:06:16,000 --> 01:06:19,599
like we are properly getting a 404.

1637
01:06:19,599 --> 01:06:22,880
And let's try the delete.

1638
01:06:22,880 --> 01:06:24,960
And we are getting a 404 with the delete

1639
01:06:24,960 --> 01:06:27,920
as well. Success. So, I purposefully

1640
01:06:27,920 --> 01:06:30,079
showed you a non-conventional way to do

1641
01:06:30,079 --> 01:06:32,240
this so you could see the power of Nest

1642
01:06:32,240 --> 01:06:34,000
bubbling up those errors to the

1643
01:06:34,000 --> 01:06:36,640
controller. Honestly, for basic apps, I

1644
01:06:36,640 --> 01:06:39,440
think it's fine to throw HTTP specific

1645
01:06:39,440 --> 01:06:41,920
exceptions inside the service and let

1646
01:06:41,920 --> 01:06:45,280
them bubble up. But as an application

1647
01:06:45,280 --> 01:06:47,039
grows, it's cleaner to let the

1648
01:06:47,039 --> 01:06:49,680
controller decide which HTTP exception

1649
01:06:49,680 --> 01:06:52,319
to return. This keeps services focused

1650
01:06:52,319 --> 01:06:54,240
on business logic and makes them

1651
01:06:54,240 --> 01:06:57,839
reusable in non-HTTP contexts where an

1652
01:06:57,839 --> 01:07:00,880
HTTP exception just wouldn't make sense.

1653
01:07:00,880 --> 01:07:02,319
In the next lesson, I'm going to show

1654
01:07:02,319 --> 01:07:06,720
you a more conventional way to do this.

1655
01:07:06,720 --> 01:07:08,400
Now, again, if you're just starting out

1656
01:07:08,400 --> 01:07:09,920
and for basic apps, I think it's

1657
01:07:09,920 --> 01:07:12,640
completely fine to handle HTTP

1658
01:07:12,640 --> 01:07:15,119
exceptions in the service layer, but let

1659
01:07:15,119 --> 01:07:16,240
me go ahead and show you a little bit

1660
01:07:16,240 --> 01:07:18,400
more of a conventional way to do this.

1661
01:07:18,400 --> 01:07:20,559
Now let's shift the responsibility of

1662
01:07:20,559 --> 01:07:22,880
handling HTTP exceptions to the

1663
01:07:22,880 --> 01:07:24,799
controller. So we'll go ahead and just

1664
01:07:24,799 --> 01:07:28,880
do this for getting a single profile. So

1665
01:07:28,880 --> 01:07:30,559
right now we're throwing the exception

1666
01:07:30,559 --> 01:07:34,799
here. What I'm actually going to do is

1667
01:07:34,799 --> 01:07:37,839
just throw an error. Let's go ahead and

1668
01:07:37,839 --> 01:07:40,640
save that. Let's go on over to our

1669
01:07:40,640 --> 01:07:43,039
controller. So we're going to go ahead

1670
01:07:43,039 --> 01:07:47,440
and wrap this in a try catch block. And

1671
01:07:47,440 --> 01:07:50,720
then we are going to just catch the

1672
01:07:50,720 --> 01:07:52,880
error. And in here we're just going to

1673
01:07:52,880 --> 01:07:56,319
throw the not found exception

1674
01:07:56,319 --> 01:07:58,640
and we're going to get the error message

1675
01:07:58,640 --> 01:08:01,520
and pass that through. So let's go ahead

1676
01:08:01,520 --> 01:08:03,920
and test this out.

1677
01:08:03,920 --> 01:08:06,640
Open up the network tab and then we're

1678
01:08:06,640 --> 01:08:09,359
going to go ahead and just we're going

1679
01:08:09,359 --> 01:08:12,240
to pass a random ID that is not going to

1680
01:08:12,240 --> 01:08:14,799
exist and we're getting a not found.

1681
01:08:14,799 --> 01:08:16,480
Now, on your screen, you might see a

1682
01:08:16,480 --> 01:08:18,159
TypeScript error. I'm not worried about

1683
01:08:18,159 --> 01:08:19,440
fixing this because we're going to move

1684
01:08:19,440 --> 01:08:21,040
on and do something a little bit more

1685
01:08:21,040 --> 01:08:23,759
specific. You might be thinking that

1686
01:08:23,759 --> 01:08:26,640
this only handles a very specific case

1687
01:08:26,640 --> 01:08:28,480
and that it's not handling other types

1688
01:08:28,480 --> 01:08:30,799
of common errors that we would handle.

1689
01:08:30,799 --> 01:08:33,120
And you'd be right. In Nest, your

1690
01:08:33,120 --> 01:08:35,359
service layer often handles requests to

1691
01:08:35,359 --> 01:08:37,920
the database. and your OM or whatever

1692
01:08:37,920 --> 01:08:39,359
library you use to structure your

1693
01:08:39,359 --> 01:08:41,600
queries often will have built-in error

1694
01:08:41,600 --> 01:08:44,000
objects that you can throw or return in

1695
01:08:44,000 --> 01:08:45,520
your service function and let your

1696
01:08:45,520 --> 01:08:48,080
controller figure out a matching HTTP

1697
01:08:48,080 --> 01:08:50,640
exception. In actual applications, we

1698
01:08:50,640 --> 01:08:51,920
would probably want to catch the error

1699
01:08:51,920 --> 01:08:54,799
in the controller like so. So maybe

1700
01:08:54,799 --> 01:08:57,600
something like

1701
01:08:57,600 --> 01:09:02,080
if error is instance of database

1702
01:09:02,080 --> 01:09:04,480
exception,

1703
01:09:04,480 --> 01:09:06,239
then we're going to go ahead and throw

1704
01:09:06,239 --> 01:09:09,040
new not found exception

1705
01:09:09,040 --> 01:09:11,199
here. Now, this isn't going to work

1706
01:09:11,199 --> 01:09:12,960
because we haven't hooked up any

1707
01:09:12,960 --> 01:09:15,839
database or imported any types for that,

1708
01:09:15,839 --> 01:09:17,440
but I just wanted to show you something

1709
01:09:17,440 --> 01:09:19,359
that you might commonly see in a

1710
01:09:19,359 --> 01:09:21,759
controller. And for many apps, the base

1711
01:09:21,759 --> 01:09:23,839
exception filter can handle a lot of

1712
01:09:23,839 --> 01:09:26,000
cases for you. But if you ever want more

1713
01:09:26,000 --> 01:09:28,000
control, you may want to build your own

1714
01:09:28,000 --> 01:09:29,920
exception filter. And for that, the

1715
01:09:29,920 --> 01:09:32,080
nests are a great resource for whenever

1716
01:09:32,080 --> 01:09:34,319
you want to dig a bit deeper. But once

1717
01:09:34,319 --> 01:09:36,480
more, I just want to stress I'm kind of

1718
01:09:36,480 --> 01:09:38,640
just showing you a little bit more of a

1719
01:09:38,640 --> 01:09:40,880
conventional way to start handling some

1720
01:09:40,880 --> 01:09:43,759
of the exceptions. Again, in your basic

1721
01:09:43,759 --> 01:09:46,000
app, I think it's completely fine to

1722
01:09:46,000 --> 01:09:48,400
throw an HTTP exception in the service

1723
01:09:48,400 --> 01:09:50,159
layer. And I honestly would just start

1724
01:09:50,159 --> 01:09:52,560
with that. Keep things simple for you

1725
01:09:52,560 --> 01:09:54,159
just so you can get an application and

1726
01:09:54,159 --> 01:09:56,800
API up and running because Nest has a

1727
01:09:56,800 --> 01:09:58,560
lot of depth to it. And I want you to be

1728
01:09:58,560 --> 01:10:00,880
very careful about how deep you dive

1729
01:10:00,880 --> 01:10:03,040
just to get a basic application up. But

1730
01:10:03,040 --> 01:10:04,800
that's pretty much all I want to go over

1731
01:10:04,800 --> 01:10:08,080
with exceptions. Now in the next lesson,

1732
01:10:08,080 --> 01:10:10,000
we're going to go over pipes and talk

1733
01:10:10,000 --> 01:10:12,480
about transformation and validation.

1734
01:10:12,480 --> 01:10:15,960
I'll see you there.

1735
01:10:16,239 --> 01:10:18,400
Pipes and nest have two typical use

1736
01:10:18,400 --> 01:10:22,000
cases, transformation and validation.

1737
01:10:22,000 --> 01:10:24,159
Transformation allows us to transform

1738
01:10:24,159 --> 01:10:26,560
input data to the desired form, such as

1739
01:10:26,560 --> 01:10:29,440
from a string to an integer. Validation

1740
01:10:29,440 --> 01:10:31,520
ensures the input data meets certain

1741
01:10:31,520 --> 01:10:33,440
rules before it proceeds further in the

1742
01:10:33,440 --> 01:10:35,600
request life cycle. Now, we're going to

1743
01:10:35,600 --> 01:10:37,199
go over both, but this lesson is

1744
01:10:37,199 --> 01:10:40,000
dedicated to transformation. Since our

1745
01:10:40,000 --> 01:10:42,960
ids are UYU IDs, why not transform

1746
01:10:42,960 --> 01:10:45,920
those? Let's use the parse UYU ID pipe

1747
01:10:45,920 --> 01:10:48,480
to try and transform our ID which we get

1748
01:10:48,480 --> 01:10:51,920
as a string into a UYU ID. So let's

1749
01:10:51,920 --> 01:10:55,120
start with our imports. We are going to

1750
01:10:55,120 --> 01:10:56,640
need

1751
01:10:56,640 --> 01:11:01,360
pars uyu ID type and then let's actually

1752
01:11:01,360 --> 01:11:04,080
go ahead and import

1753
01:11:04,080 --> 01:11:07,520
uh we'll make this a type.

1754
01:11:07,520 --> 01:11:10,480
So we're going to import the UYU ID type

1755
01:11:10,480 --> 01:11:12,560
from crypto.

1756
01:11:12,560 --> 01:11:15,360
If we move on down to our get a single

1757
01:11:15,360 --> 01:11:18,239
profile route, we have our ID pram, but

1758
01:11:18,239 --> 01:11:20,480
it remains a string. So let's go ahead

1759
01:11:20,480 --> 01:11:24,960
and transform it into a proper UYU ID.

1760
01:11:24,960 --> 01:11:26,480
And then for TypeScript, we already

1761
01:11:26,480 --> 01:11:28,880
imported the type.

1762
01:11:28,880 --> 01:11:31,679
Now, as always, let's test this out. So

1763
01:11:31,679 --> 01:11:34,080
we're going to need the network tool. We

1764
01:11:34,080 --> 01:11:36,080
first need a list of active ids to test

1765
01:11:36,080 --> 01:11:38,560
this out. So let's go ahead and grab

1766
01:11:38,560 --> 01:11:40,960
those. And if we take a look at the

1767
01:11:40,960 --> 01:11:42,800
response, we can go ahead and grab

1768
01:11:42,800 --> 01:11:45,800
Briana's.

1769
01:11:46,320 --> 01:11:48,000
And let's just make sure this is still

1770
01:11:48,000 --> 01:11:50,320
working. Perfect. We see Brianna's

1771
01:11:50,320 --> 01:11:52,960
profile. Now, UYU IDs have a very

1772
01:11:52,960 --> 01:11:54,800
specific format you got to follow. So,

1773
01:11:54,800 --> 01:11:56,640
let's actually just try deleting the

1774
01:11:56,640 --> 01:11:59,840
last character.

1775
01:11:59,840 --> 01:12:01,600
And what do you know? We see validation

1776
01:12:01,600 --> 01:12:03,920
failed. So, it attempted to transform

1777
01:12:03,920 --> 01:12:06,800
it, but it detected a bad UU ID format.

1778
01:12:06,800 --> 01:12:08,560
So, it was unable to do so. And we got a

1779
01:12:08,560 --> 01:12:10,560
validation error. This is exactly what

1780
01:12:10,560 --> 01:12:13,120
we want because now our route can always

1781
01:12:13,120 --> 01:12:16,000
expect a proper UYU ID to work with. All

1782
01:12:16,000 --> 01:12:18,239
right, it's time for your challenge. Let

1783
01:12:18,239 --> 01:12:19,840
me go ahead and copy and paste in the

1784
01:12:19,840 --> 01:12:22,239
challenge text for you.

1785
01:12:22,239 --> 01:12:24,800
So, if you remember, we have an ID pram

1786
01:12:24,800 --> 01:12:27,360
for both the put and delete routes. I

1787
01:12:27,360 --> 01:12:28,800
want you to go ahead and use the parse

1788
01:12:28,800 --> 01:12:30,719
UYU ID pipe on those as well and

1789
01:12:30,719 --> 01:12:33,360
transform that ID. And as always, don't

1790
01:12:33,360 --> 01:12:35,280
forget to test your code. Remember, you

1791
01:12:35,280 --> 01:12:37,040
have to put and delete shell scripts to

1792
01:12:37,040 --> 01:12:41,719
do so. All right, good luck.

1793
01:12:43,199 --> 01:12:46,159
I hope that went well. Let's go ahead

1794
01:12:46,159 --> 01:12:49,360
and implement it with a put first. So,

1795
01:12:49,360 --> 01:12:52,159
we have the ID pram. We want to go ahead

1796
01:12:52,159 --> 01:12:55,760
and parse this. And then we also want to

1797
01:12:55,760 --> 01:12:58,640
change this for TypeScript.

1798
01:12:58,640 --> 01:13:00,159
And I'm actually going to go ahead and

1799
01:13:00,159 --> 01:13:02,480
just copy and paste the same thing for

1800
01:13:02,480 --> 01:13:05,520
our delete route.

1801
01:13:05,520 --> 01:13:07,920
As always, we want to test this out.

1802
01:13:07,920 --> 01:13:11,679
Let's grab an active profile. So, first

1803
01:13:11,679 --> 01:13:13,600
we'll try to change the profile, Brianna

1804
01:13:13,600 --> 01:13:15,199
Watts, and then we're going to try to

1805
01:13:15,199 --> 01:13:18,520
delete it.

1806
01:13:18,880 --> 01:13:22,480
Let's head on over to our put and then

1807
01:13:22,480 --> 01:13:24,719
we're going to replace this ID and we're

1808
01:13:24,719 --> 01:13:28,920
first going to try to change it.

1809
01:13:32,080 --> 01:13:33,760
All right, let's just double check that

1810
01:13:33,760 --> 01:13:37,560
it actually did change.

1811
01:13:38,239 --> 01:13:41,280
And we see Kai. Perfect. Now, let's go

1812
01:13:41,280 --> 01:13:42,960
ahead and test it out with an improper

1813
01:13:42,960 --> 01:13:46,440
UU ID.

1814
01:13:51,600 --> 01:13:53,840
It looks like our pipe is working and

1815
01:13:53,840 --> 01:13:56,239
failed to transform it because we did

1816
01:13:56,239 --> 01:13:59,440
not have a proper UYU ID for our string.

1817
01:13:59,440 --> 01:14:01,920
Let's just make sure Kai is still there.

1818
01:14:01,920 --> 01:14:04,480
All right. Now, let's try to delete Kai.

1819
01:14:04,480 --> 01:14:06,560
But before we do, let's give it an

1820
01:14:06,560 --> 01:14:10,600
improper UU ID.

1821
01:14:14,640 --> 01:14:16,960
And it looks like our pipe is working.

1822
01:14:16,960 --> 01:14:20,480
Let's give it a proper one.

1823
01:14:20,480 --> 01:14:22,560
And I went ahead and just pasted Kaizen

1824
01:14:22,560 --> 01:14:24,159
just to make sure that we can actually

1825
01:14:24,159 --> 01:14:27,719
delete this successfully.

1826
01:14:30,640 --> 01:14:32,719
All right, so we are getting a 204.

1827
01:14:32,719 --> 01:14:35,679
Let's test it out. Profile not found.

1828
01:14:35,679 --> 01:14:38,159
Success. That's all you need for a first

1829
01:14:38,159 --> 01:14:40,400
look at built-in pipes. You've seen how

1830
01:14:40,400 --> 01:14:42,880
they can transform raw strings into UYU

1831
01:14:42,880 --> 01:14:44,480
IDs, and there are plenty of others you

1832
01:14:44,480 --> 01:14:46,320
can try out. Now that our route

1833
01:14:46,320 --> 01:14:47,840
parameters are guaranteed to be the

1834
01:14:47,840 --> 01:14:50,000
right type, we need to be sure each

1835
01:14:50,000 --> 01:14:53,120
request body also contains valid values.

1836
01:14:53,120 --> 01:14:54,960
In the next lesson, we'll use Nest

1837
01:14:54,960 --> 01:14:57,440
validation pipe, add class validator

1838
01:14:57,440 --> 01:14:59,679
decorators to our DTOS, and watch Nest

1839
01:14:59,679 --> 01:15:01,520
reject bad payloads before they ever

1840
01:15:01,520 --> 01:15:05,120
even reach our controller.

1841
01:15:05,120 --> 01:15:07,360
While Nest provides some simple, common

1842
01:15:07,360 --> 01:15:09,679
out-of-the-box pipes for us to use, we

1843
01:15:09,679 --> 01:15:11,920
may want to get more granular with what

1844
01:15:11,920 --> 01:15:14,880
we expect from the data. For example,

1845
01:15:14,880 --> 01:15:16,800
maybe we want each name to have a

1846
01:15:16,800 --> 01:15:18,800
minimum amount of characters. So, let's

1847
01:15:18,800 --> 01:15:21,040
go ahead and add that. Before we start

1848
01:15:21,040 --> 01:15:22,400
though, we'll need to install two

1849
01:15:22,400 --> 01:15:23,840
libraries that'll give us a bunch of

1850
01:15:23,840 --> 01:15:25,360
extra decorators that we can use to

1851
01:15:25,360 --> 01:15:29,239
validate incoming data.

1852
01:15:29,840 --> 01:15:31,600
That's class validator and class

1853
01:15:31,600 --> 01:15:33,600
transformer. While we'll only be

1854
01:15:33,600 --> 01:15:36,080
importing from class validator in our

1855
01:15:36,080 --> 01:15:38,560
simple validation examples, it's common

1856
01:15:38,560 --> 01:15:40,640
and even recommended in the nest docs to

1857
01:15:40,640 --> 01:15:42,960
install both. Class transformer lets

1858
01:15:42,960 --> 01:15:45,520
validation pipe convert plain JavaScript

1859
01:15:45,520 --> 01:15:48,480
objects into instances of classes so

1860
01:15:48,480 --> 01:15:51,120
decorators can read them. They both work

1861
01:15:51,120 --> 01:15:53,360
really well together, especially as your

1862
01:15:53,360 --> 01:15:55,679
transformations and validations get more

1863
01:15:55,679 --> 01:15:57,760
complex. Now that these are installed,

1864
01:15:57,760 --> 01:15:59,520
we can add a few useful decorators to

1865
01:15:59,520 --> 01:16:02,159
the create profile DTO class. Let's go

1866
01:16:02,159 --> 01:16:05,679
ahead and head on there.

1867
01:16:05,679 --> 01:16:07,360
So, first let's go ahead and import

1868
01:16:07,360 --> 01:16:10,080
them. So let's just check for a string

1869
01:16:10,080 --> 01:16:11,920
and then we're going to give a specific

1870
01:16:11,920 --> 01:16:14,880
length that the name needs to have. So

1871
01:16:14,880 --> 01:16:16,159
it's really simple to add these

1872
01:16:16,159 --> 01:16:19,159
decorators.

1873
01:16:20,480 --> 01:16:22,719
So length is going to take a minimum

1874
01:16:22,719 --> 01:16:25,280
amount of characters and a maximum. So I

1875
01:16:25,280 --> 01:16:26,880
think three is good for the minimum and

1876
01:16:26,880 --> 01:16:29,440
then we'll say 100 for the maximum. That

1877
01:16:29,440 --> 01:16:32,000
should do it. And then we just want to

1878
01:16:32,000 --> 01:16:34,480
make sure that the description is a

1879
01:16:34,480 --> 01:16:37,120
string as well. Now, this won't quite

1880
01:16:37,120 --> 01:16:39,199
work yet. We first need to bind the

1881
01:16:39,199 --> 01:16:41,600
validation pipe. Let's bind the pipe

1882
01:16:41,600 --> 01:16:43,440
instance to the route handler body so

1883
01:16:43,440 --> 01:16:45,040
that our pipe is called to validate the

1884
01:16:45,040 --> 01:16:46,800
body. So, we'll do that in our

1885
01:16:46,800 --> 01:16:49,120
controller.

1886
01:16:49,120 --> 01:16:53,440
So, let's go ahead and bind it like so.

1887
01:16:53,440 --> 01:16:55,040
And then we are going to need to import

1888
01:16:55,040 --> 01:16:58,040
it.

1889
01:17:03,360 --> 01:17:05,520
Now, let's go ahead and test it out.

1890
01:17:05,520 --> 01:17:08,640
So, we're actually going to go to our

1891
01:17:08,640 --> 01:17:12,080
post shell script and then let's try to

1892
01:17:12,080 --> 01:17:14,960
create kai and just make it ka and see

1893
01:17:14,960 --> 01:17:18,760
if we get rejected.

1894
01:17:21,199 --> 01:17:23,199
And we are getting a bad request and the

1895
01:17:23,199 --> 01:17:25,199
message name must be longer than or

1896
01:17:25,199 --> 01:17:27,840
equal to three characters. Now, let's go

1897
01:17:27,840 --> 01:17:30,560
ahead and add the i back and try it

1898
01:17:30,560 --> 01:17:33,120
again.

1899
01:17:33,120 --> 01:17:35,760
And success. Now it's time for your

1900
01:17:35,760 --> 01:17:37,520
challenge.

1901
01:17:37,520 --> 01:17:38,960
Let me go ahead and copy and paste in

1902
01:17:38,960 --> 01:17:42,400
the challenge text.

1903
01:17:42,400 --> 01:17:43,920
So you're going to add the validation

1904
01:17:43,920 --> 01:17:46,560
pipe for the body in our put route.

1905
01:17:46,560 --> 01:17:48,640
Using class validator, add a couple of

1906
01:17:48,640 --> 01:17:51,199
decorators to our update profile DTO to

1907
01:17:51,199 --> 01:17:52,800
create more granular restrictions for

1908
01:17:52,800 --> 01:17:54,960
the values. And feel free to look up

1909
01:17:54,960 --> 01:17:57,040
class validator and just explore what

1910
01:17:57,040 --> 01:17:59,199
decorators it provides. Maybe try

1911
01:17:59,199 --> 01:18:00,400
something different than the length

1912
01:18:00,400 --> 01:18:02,480
decorator that we used. All right, I'll

1913
01:18:02,480 --> 01:18:06,679
let you get to it. Good luck.

1914
01:18:08,159 --> 01:18:10,560
I hope that went well. So, let's go

1915
01:18:10,560 --> 01:18:13,120
ahead and get started in our update

1916
01:18:13,120 --> 01:18:15,520
profile DTO. Let's import our

1917
01:18:15,520 --> 01:18:17,920
decorators. And you know what? Let's go

1918
01:18:17,920 --> 01:18:22,640
with min length. So, name is going to be

1919
01:18:22,640 --> 01:18:26,320
is string and length or min length.

1920
01:18:26,320 --> 01:18:29,280
We'll set that

1921
01:18:29,280 --> 01:18:32,640
to let's just stick with three. and then

1922
01:18:32,640 --> 01:18:36,000
our description is going to be a string.

1923
01:18:36,000 --> 01:18:39,280
Let's head on over to our controller.

1924
01:18:39,280 --> 01:18:42,400
And then again in the body, we're going

1925
01:18:42,400 --> 01:18:44,719
to create a new validation pipe and

1926
01:18:44,719 --> 01:18:48,440
let's test it out.

1927
01:18:50,239 --> 01:18:52,159
So it looks like we got validation

1928
01:18:52,159 --> 01:18:56,600
failed. Let's see what happened.

1929
01:18:58,400 --> 01:19:01,120
So if we look back at our terminal,

1930
01:19:01,120 --> 01:19:02,880
hopefully you remember what to do with

1931
01:19:02,880 --> 01:19:05,520
this. So we first need to make sure that

1932
01:19:05,520 --> 01:19:08,320
we are providing a proper UYU ID. So

1933
01:19:08,320 --> 01:19:10,400
let's go ahead and grab one. We'll just

1934
01:19:10,400 --> 01:19:14,199
copy and paste this.

1935
01:19:17,840 --> 01:19:22,280
Now I expect this to be successful

1936
01:19:22,480 --> 01:19:26,880
and it was. Now let's break it.

1937
01:19:26,880 --> 01:19:29,120
name must be longer than or equal to

1938
01:19:29,120 --> 01:19:32,320
three characters. It's working. Also,

1939
01:19:32,320 --> 01:19:35,199
notice how we bound each validation pipe

1940
01:19:35,199 --> 01:19:37,760
to each body. While this gives us more

1941
01:19:37,760 --> 01:19:39,679
granular control over which route we

1942
01:19:39,679 --> 01:19:42,000
want to apply it to, it's more common to

1943
01:19:42,000 --> 01:19:43,920
protect all of your endpoints by binding

1944
01:19:43,920 --> 01:19:46,560
it at the application level. Let me go

1945
01:19:46,560 --> 01:19:48,159
ahead and show you how to do that. So,

1946
01:19:48,159 --> 01:19:50,640
first we're going to get rid of the two

1947
01:19:50,640 --> 01:19:53,760
additions here.

1948
01:19:53,760 --> 01:19:55,679
And then we're going to go into our

1949
01:19:55,679 --> 01:19:59,120
Bootstrap file, which should be main.

1950
01:19:59,120 --> 01:20:02,159
And then we're going to set up a global

1951
01:20:02,159 --> 01:20:05,040
pipe.

1952
01:20:05,040 --> 01:20:07,520
And that is going to be our validation

1953
01:20:07,520 --> 01:20:09,760
pipe.

1954
01:20:09,760 --> 01:20:12,400
So, we're going to need to import that.

1955
01:20:12,400 --> 01:20:14,400
Let's going back over to our controller.

1956
01:20:14,400 --> 01:20:16,719
So, we don't have it here or here. Let's

1957
01:20:16,719 --> 01:20:21,040
test it out. If we look at our putshell

1958
01:20:21,040 --> 01:20:25,120
script, this should break.

1959
01:20:27,360 --> 01:20:29,679
name must be longer than or equal to

1960
01:20:29,679 --> 01:20:32,640
three characters. Perfect. It's working.

1961
01:20:32,640 --> 01:20:34,159
By the way, when I say break, I just

1962
01:20:34,159 --> 01:20:36,159
mean the payloads rejected. But you get

1963
01:20:36,159 --> 01:20:39,440
the gist. Now, given that Nest is full

1964
01:20:39,440 --> 01:20:41,760
of classes, class validator is a

1965
01:20:41,760 --> 01:20:43,760
fantastic library to give you a ton of

1966
01:20:43,760 --> 01:20:45,679
extra convenient validations for your

1967
01:20:45,679 --> 01:20:48,400
data.

1968
01:20:48,400 --> 01:20:51,040
Guards and Nest have one purpose to

1969
01:20:51,040 --> 01:20:53,199
determine whether a given request will

1970
01:20:53,199 --> 01:20:56,080
be handled by the route handler or not.

1971
01:20:56,080 --> 01:20:58,400
For example, think authorization. Maybe

1972
01:20:58,400 --> 01:21:00,640
we just want admins to be the only one

1973
01:21:00,640 --> 01:21:03,679
who can delete profiles or we want users

1974
01:21:03,679 --> 01:21:05,840
to only be able to update their own

1975
01:21:05,840 --> 01:21:08,400
profile. We can actually use the CLI to

1976
01:21:08,400 --> 01:21:10,320
get us started. So, let's go ahead and

1977
01:21:10,320 --> 01:21:12,400
open up the terminal. And then we're

1978
01:21:12,400 --> 01:21:14,239
going to go ahead and generate a new

1979
01:21:14,239 --> 01:21:16,719
guard for profiles. All right, let's

1980
01:21:16,719 --> 01:21:20,320
take a look. So in profiles, we do see

1981
01:21:20,320 --> 01:21:22,880
that there is a new guard. Remember, a

1982
01:21:22,880 --> 01:21:25,040
guard's single responsibility is to

1983
01:21:25,040 --> 01:21:27,120
determine whether or not a given request

1984
01:21:27,120 --> 01:21:29,120
will be handled or not. So the main

1985
01:21:29,120 --> 01:21:31,520
thing it needs to do is return a true or

1986
01:21:31,520 --> 01:21:34,560
false based on the logic you set up.

1987
01:21:34,560 --> 01:21:36,239
Let's go ahead and bind this to a route

1988
01:21:36,239 --> 01:21:38,560
to get it working.

1989
01:21:38,560 --> 01:21:40,960
So we can actually get rid of validation

1990
01:21:40,960 --> 01:21:44,239
pipe and we're going to import use

1991
01:21:44,239 --> 01:21:47,199
guards from nest common. And then let's

1992
01:21:47,199 --> 01:21:49,920
go ahead and import our guard and we

1993
01:21:49,920 --> 01:21:51,760
need to bind it. Let's go ahead and bind

1994
01:21:51,760 --> 01:21:55,800
it to the delete route.

1995
01:21:58,560 --> 01:22:01,360
So we take a look at our guard. It looks

1996
01:22:01,360 --> 01:22:03,520
like we are returning true. So it should

1997
01:22:03,520 --> 01:22:06,239
let the request pass through. And then

1998
01:22:06,239 --> 01:22:08,320
if we take a look at delete, what we

1999
01:22:08,320 --> 01:22:10,159
probably should get is a validation

2000
01:22:10,159 --> 01:22:12,480
error because this is not a proper UYU

2001
01:22:12,480 --> 01:22:14,239
ID.

2002
01:22:14,239 --> 01:22:18,120
So let's test it out.

2003
01:22:19,600 --> 01:22:21,760
All right. So we got our validation

2004
01:22:21,760 --> 01:22:24,239
error. Now let's see what happens when

2005
01:22:24,239 --> 01:22:28,040
we return false.

2006
01:22:32,480 --> 01:22:35,040
And we get a 403 forbidden. Perfect.

2007
01:22:35,040 --> 01:22:37,120
That's exactly what we want at a

2008
01:22:37,120 --> 01:22:38,800
fundamental level. That's how a guard

2009
01:22:38,800 --> 01:22:40,719
works. It either returns true or false,

2010
01:22:40,719 --> 01:22:43,520
accepting or rejecting the request. Now,

2011
01:22:43,520 --> 01:22:45,600
let's take a closer look at this custom

2012
01:22:45,600 --> 01:22:48,400
guard. Now, I don't expect you to

2013
01:22:48,400 --> 01:22:50,000
remember all this. I just want to show

2014
01:22:50,000 --> 01:22:52,159
you this. If you use something like

2015
01:22:52,159 --> 01:22:55,120
passport.js, it provides the decorators

2016
01:22:55,120 --> 01:22:56,960
to be able to just import the proper

2017
01:22:56,960 --> 01:22:58,880
guard in your controller and bind it

2018
01:22:58,880 --> 01:23:01,199
without you having to go into creating

2019
01:23:01,199 --> 01:23:03,120
some custom guard for yourself, unless

2020
01:23:03,120 --> 01:23:05,040
you want to. But I just want to show you

2021
01:23:05,040 --> 01:23:06,719
this to give you a little bit more

2022
01:23:06,719 --> 01:23:10,480
context. So every guard must implement a

2023
01:23:10,480 --> 01:23:13,280
can activate function. We can get

2024
01:23:13,280 --> 01:23:15,440
information from the request through

2025
01:23:15,440 --> 01:23:17,280
context. And we need to decide if we

2026
01:23:17,280 --> 01:23:18,960
should allow this request to pass to our

2027
01:23:18,960 --> 01:23:21,120
controller method or not. So for

2028
01:23:21,120 --> 01:23:23,360
example, let's go ahead and grab the

2029
01:23:23,360 --> 01:23:25,040
request.

2030
01:23:25,040 --> 01:23:27,600
And now let's pretend that we have an

2031
01:23:27,600 --> 01:23:31,440
authenticate function.

2032
01:23:31,440 --> 01:23:33,199
So I'm not going to import it. I'm not

2033
01:23:33,199 --> 01:23:34,639
going to create it, but let's just

2034
01:23:34,639 --> 01:23:36,719
pretend we do. And then in that

2035
01:23:36,719 --> 01:23:38,639
authenticate function, we want to pass a

2036
01:23:38,639 --> 01:23:40,320
request and let our authenticate

2037
01:23:40,320 --> 01:23:42,639
function deal with the authentication

2038
01:23:42,639 --> 01:23:45,360
logic. And we applied a guard to a

2039
01:23:45,360 --> 01:23:47,280
specific controller method. But as you

2040
01:23:47,280 --> 01:23:49,199
may suspect, just like validation pipe,

2041
01:23:49,199 --> 01:23:50,960
guards can be applied to a broader scope

2042
01:23:50,960 --> 01:23:53,040
such as the controller class or globally

2043
01:23:53,040 --> 01:23:55,679
as well. Guards are very commonly used

2044
01:23:55,679 --> 01:23:57,679
for authorization. I wanted to avoid

2045
01:23:57,679 --> 01:24:00,080
diving deep into authorization in this

2046
01:24:00,080 --> 01:24:01,520
course and just focus on the

2047
01:24:01,520 --> 01:24:03,760
fundamentals of Nest, but the concept of

2048
01:24:03,760 --> 01:24:05,600
guards is pretty simple and Nest's great

2049
01:24:05,600 --> 01:24:07,760
documentation for implementing them.

2050
01:24:07,760 --> 01:24:09,440
Most likely though, you're probably just

2051
01:24:09,440 --> 01:24:11,360
going to use the passport integration if

2052
01:24:11,360 --> 01:24:13,120
you want to implement authorization in

2053
01:24:13,120 --> 01:24:16,080
your app. That's it for our lesson on an

2054
01:24:16,080 --> 01:24:17,760
intro to guards. I'll see you in the

2055
01:24:17,760 --> 01:24:20,920
next lesson.

2056
01:24:21,440 --> 01:24:23,440
Congratulations on completing this

2057
01:24:23,440 --> 01:24:26,000
course. You just built a REST API with

2058
01:24:26,000 --> 01:24:28,159
Nest building blocks, modules,

2059
01:24:28,159 --> 01:24:31,199
controllers, services, and DTO's, plus

2060
01:24:31,199 --> 01:24:33,679
pipes for transformation and validation,

2061
01:24:33,679 --> 01:24:36,159
guards for authorization, and exception

2062
01:24:36,159 --> 01:24:38,400
filters for graceful error handling.

2063
01:24:38,400 --> 01:24:40,480
That's miles beyond the typical Hello

2064
01:24:40,480 --> 01:24:42,800
Express app. Give yourself a pat on the

2065
01:24:42,800 --> 01:24:44,639
back. You've shown that you're curious

2066
01:24:44,639 --> 01:24:46,239
and are taking your growth into becoming

2067
01:24:46,239 --> 01:24:48,719
a better back-end developer seriously.

2068
01:24:48,719 --> 01:24:51,360
So, I bet you're asking, what's next? If

2069
01:24:51,360 --> 01:24:53,360
you want to continue learning and diving

2070
01:24:53,360 --> 01:24:56,080
deeper into Nest, consider connecting a

2071
01:24:56,080 --> 01:24:58,880
database. Try the type OM or Prisma

2072
01:24:58,880 --> 01:25:01,120
guides in the docs to persist profiles

2073
01:25:01,120 --> 01:25:04,159
instead of using an in-memory array. I

2074
01:25:04,159 --> 01:25:06,320
actually switched from Prisma to type OM

2075
01:25:06,320 --> 01:25:08,800
recently and I'm loving it. You can also

2076
01:25:08,800 --> 01:25:11,360
set up authentication and authorization.

2077
01:25:11,360 --> 01:25:13,360
Follow the official Passport recipe.

2078
01:25:13,360 --> 01:25:15,360
Passport's a really common thing to use

2079
01:25:15,360 --> 01:25:17,840
with NestJS and set up some role-based

2080
01:25:17,840 --> 01:25:19,360
guards with it. And you can also use

2081
01:25:19,360 --> 01:25:21,199
encryption and hashing utilities for

2082
01:25:21,199 --> 01:25:23,360
passwords. And if you want to write some

2083
01:25:23,360 --> 01:25:25,679
automated tests for what we built even

2084
01:25:25,679 --> 01:25:29,280
so far, go for it. Nest shifts readyto

2085
01:25:29,280 --> 01:25:30,960
use unit and end to end test

2086
01:25:30,960 --> 01:25:33,280
scaffolding. Fire up justest and protect

2087
01:25:33,280 --> 01:25:35,600
your controllers and services. Or if you

2088
01:25:35,600 --> 01:25:37,440
have more experience with frontend and

2089
01:25:37,440 --> 01:25:39,199
you finally want to build out your own

2090
01:25:39,199 --> 01:25:40,960
API documentation that you've been

2091
01:25:40,960 --> 01:25:42,719
utilizing when working with other

2092
01:25:42,719 --> 01:25:45,520
backend teams, add swagger or open API

2093
01:25:45,520 --> 01:25:47,679
to your project and generate live API

2094
01:25:47,679 --> 01:25:50,159
docs for your project. Nest makes this

2095
01:25:50,159 --> 01:25:52,639
really easy. My own projects, I love

2096
01:25:52,639 --> 01:25:54,880
using Nest CLI plugin that autogenerates

2097
01:25:54,880 --> 01:25:57,760
the open API docs from decorators or

2098
01:25:57,760 --> 01:26:00,080
deploy your application. Read about Nest

2099
01:26:00,080 --> 01:26:01,679
recommended deployment practices to get

2100
01:26:01,679 --> 01:26:03,679
your website live so that you can show

2101
01:26:03,679 --> 01:26:06,000
others what you built. Now, in my

2102
01:26:06,000 --> 01:26:07,600
personal opinion, if you're pretty fresh

2103
01:26:07,600 --> 01:26:09,840
with a backend, that is going to be a

2104
01:26:09,840 --> 01:26:12,239
pretty big hurdle. If you want an easier

2105
01:26:12,239 --> 01:26:14,960
hosting solution, I highly recommend

2106
01:26:14,960 --> 01:26:17,040
third party guides for something like

2107
01:26:17,040 --> 01:26:19,199
hosting your Nest app on Render,

2108
01:26:19,199 --> 01:26:22,159
Railway, or Heroku. It really simplifies

2109
01:26:22,159 --> 01:26:24,560
the DevOps part of hosting your web app.

2110
01:26:24,560 --> 01:26:25,920
But if you're going to start anywhere,

2111
01:26:25,920 --> 01:26:28,159
start with the Nest Docs. If you truly

2112
01:26:28,159 --> 01:26:29,520
want to get better with Nest and you

2113
01:26:29,520 --> 01:26:31,120
want to build great things with it,

2114
01:26:31,120 --> 01:26:32,320
you're going to be spending a lot of

2115
01:26:32,320 --> 01:26:35,040
your time there. Now, you can continue

2116
01:26:35,040 --> 01:26:37,040
learning Nest and continue building on

2117
01:26:37,040 --> 01:26:39,520
the project we built together, but maybe

2118
01:26:39,520 --> 01:26:41,840
start with building out your own basic

2119
01:26:41,840 --> 01:26:44,719
API first. Try to replicate what we just

2120
01:26:44,719 --> 01:26:47,120
did, but with your idea, or even take

2121
01:26:47,120 --> 01:26:49,040
one of your Express apps and convert

2122
01:26:49,040 --> 01:26:52,159
that over to Nest. Just whatever you do,

2123
01:26:52,159 --> 01:26:54,880
don't get trapped in tutorial hell. If

2124
01:26:54,880 --> 01:26:56,480
you want this stuff to stick, if you

2125
01:26:56,480 --> 01:26:58,239
want to grow as a software engineer, you

2126
01:26:58,239 --> 01:27:00,880
have to build. And remember, Nest is

2127
01:27:00,880 --> 01:27:03,040
built for large maintainable TypeScript

2128
01:27:03,040 --> 01:27:05,760
apps. So, if it still feels a little

2129
01:27:05,760 --> 01:27:07,679
overwhelming, that's normal. Give

2130
01:27:07,679 --> 01:27:09,679
yourself weeks or even months of

2131
01:27:09,679 --> 01:27:11,520
building with Nest, and those decorators

2132
01:27:11,520 --> 01:27:13,760
will feel like second nature. And most

2133
01:27:13,760 --> 01:27:15,600
importantly, thanks for coding along

2134
01:27:15,600 --> 01:27:17,600
with me. Software engineering is a

2135
01:27:17,600 --> 01:27:19,280
never- ending journey, and that's one

2136
01:27:19,280 --> 01:27:21,199
thing I love about it. There's always

2137
01:27:21,199 --> 01:27:23,199
room to grow and more challenges to

2138
01:27:23,199 --> 01:27:25,280
tackle. If you'd like to follow along on

2139
01:27:25,280 --> 01:27:27,280
my journey and where I also share a ton

2140
01:27:27,280 --> 01:27:29,600
of advice for junior developers, check

2141
01:27:29,600 --> 01:27:31,760
out my YouTube channel. And you're also

2142
01:27:31,760 --> 01:27:33,920
welcome to follow me on X or LinkedIn.

2143
01:27:33,920 --> 01:27:36,400
But that's it for this course. Go build

2144
01:27:36,400 --> 01:27:40,000
something awesome and happy coding.